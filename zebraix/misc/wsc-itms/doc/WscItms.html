<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="J. Alex Stark" />
  <meta name="dcterms.date" content="2023-01-01" />
  <title>WSC Information-Transfer Mergesort</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="crested.css" />
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        "HTML-CSS": { scale: 90, linebreaks: { automatic: true }, fonts: ["TeX", "STIX"] },
        SVG: { linebreaks: { automatic:true }, font: "Neo-Euler" },
        // displayAlign: "left"
    });
  </script>
  <script
  src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">WSC Information-Transfer Mergesort</h1>
<p class="author">J. Alex Stark</p>
<p class="date">2023</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#preliminary-remarks"><span
class="toc-section-number">1</span> Preliminary remarks</a></li>
<li><a href="#comparison-sorting"><span
class="toc-section-number">2</span> Comparison sorting</a>
<ul>
<li><a href="#mergesort"><span class="toc-section-number">2.1</span>
Mergesort</a></li>
<li><a href="#transfer-of-information"><span
class="toc-section-number">2.2</span> Transfer of information</a></li>
<li><a href="#beating-the-bound"><span
class="toc-section-number">2.3</span> Beating the bound</a></li>
</ul></li>
<li><a href="#patterns-of-interest"><span
class="toc-section-number">3</span> Patterns of interest</a>
<ul>
<li><a href="#main-patterns"><span class="toc-section-number">3.1</span>
Main patterns</a></li>
<li><a href="#further-patterns"><span
class="toc-section-number">3.2</span> Further patterns</a></li>
</ul></li>
<li><a href="#drawing-up-anchors"><span
class="toc-section-number">4</span> Drawing up anchors</a>
<ul>
<li><a href="#anchors-and-lozenges"><span
class="toc-section-number">4.1</span> Anchors and lozenges</a></li>
<li><a href="#anchor-comparisons"><span
class="toc-section-number">4.2</span> Anchor comparisons</a></li>
<li><a href="#way-sort"><span class="toc-section-number">4.3</span>
4-way sort</a></li>
</ul></li>
<li><a href="#vector-divide-and-conquer"><span
class="toc-section-number">5</span> Vector divide-and-conquer</a></li>
<li><a href="#dags-of-order-dimension-2"><span
class="toc-section-number">6</span> DAGs of order-dimension 2</a>
<ul>
<li><a href="#concepts"><span class="toc-section-number">6.1</span>
Concepts</a></li>
<li><a href="#sorting-as-a-task-in-dominance-drawing"><span
class="toc-section-number">6.2</span> Sorting as a task in dominance
drawing</a></li>
<li><a href="#tree-edge-construction"><span
class="toc-section-number">6.3</span> Tree-edge construction</a></li>
</ul></li>
<li><a href="#analysis"><span class="toc-section-number">7</span>
Analysis</a>
<ul>
<li><a href="#implementation"><span
class="toc-section-number">7.1</span> Implementation</a></li>
<li><a href="#results"><span class="toc-section-number">7.2</span>
Results</a>
<ul>
<li><a href="#uniformly-random-arrangements"><span
class="toc-section-number">7.2.1</span> Uniformly random
arrangements</a></li>
<li><a href="#main-patterns-1"><span
class="toc-section-number">7.2.2</span> Main patterns</a></li>
<li><a href="#additional-patterns-and-tests"><span
class="toc-section-number">7.2.3</span> Additional patterns and
tests</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<hr />
<p>Heptodes documents and other content in <code>doc</code> directories
are licensed under the <a href="CC%20BY%204.0%20license">Creative
Commons Attribution 4.0 License</a>.</p>
<p>Source code licensed and code samples are licensed under the <a
href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0
License</a>.</p>
<p>The CC BY 4.0 license requires attribution. When samples, examples,
figures, tables, or other excerpts, are used in a tutorial, or a
subdivision thereof, it is sufficient to provide the complete source and
license information once. This must be close to the beginning, such as
in an early acknowledgments slide. If this is done, only short notes are
required to be placed with each usage, such as in figure captions.</p>
<hr />
<!-- md-formatter off (Document metadata) -->
<!-- md-formatter on -->
<h1 data-number="1" id="preliminary-remarks"><span
class="header-section-number">1</span> Preliminary remarks</h1>
<p>This document describes the main ideas, implementation and design of
an investigation into some variations on mergesort. Summary results are
presented. This project is a side project to a side project, and so time
for exploration and presentation of results was severely constrained.
There are various consequences of this.</p>
<ul>
<li><p>This documentation is very rough. With more time the presentation
could be made more concise and clear.</p></li>
<li><p>Performance evaluation is almost solely a strict count of
comparisons.</p></li>
<li><p>Little consideration is given to locality of reference, or to any
practical sorting considerations.</p></li>
<li><p>No ‘field study’ was conducted into what sort patterns arise in
practical situations.</p></li>
<li><p>Code developed for the project is very unpolished, with little
optimization.</p></li>
<li><p>Little consideration was given to storage.</p></li>
<li><p>Code was developed in Rust. This choice was made in the project
out of which this (sub-)project arose, and not because it was thought
best for this project.</p></li>
<li><p>We only compare performance against standard mergesort, and do
not survey enhancements to mergesort.</p></li>
</ul>
<h1 data-number="2" id="comparison-sorting"><span
class="header-section-number">2</span> Comparison sorting</h1>
<h2 data-number="2.1" id="mergesort"><span
class="header-section-number">2.1</span> Mergesort</h2>
<p>The project was framed as an exploration into comparison sorting
where the count of the number of comparisons is the overriding
efficiency criterion.</p>
<p>Comparison sorting is sorting in which the only question we can,
so-to-speak, as of the data is which of two elements (members) comes
before the other. The classic complexity bound is that, if all input
arrangements are equally likely, then the average number of comparison
requests must be at least <span
class="math inline">\(\log_2(N!)\)</span>.</p>
<p>Mergesort is the standard against which we compare our results. Some
reasons for this follow.</p>
<ol type="1">
<li>The average number pf comparisons, for equally likely input
arrangements, is quite close to the bound.</li>
<li>The worst case (worst across input arrangements) is very good.</li>
<li>The algorithm is quite simple, without complex conditions. (That is,
branches and so on.)</li>
</ol>
<p>We did not have the resources to compare with enhancements to
mergesort and in particular those known as adaptive mergesorts.</p>
<h2 data-number="2.2" id="transfer-of-information"><span
class="header-section-number">2.2</span> Transfer of information</h2>
<p>The methods that we explored we call information transfer mergesorts.
There is a significant distinction between these and many adaptive
mergesorts. An adaptive mergesort seeks to adapt the mergesorts to
detectable patterns. Doing so enables them to be much more efficient for
special cases, while incurring what might be called a detection cost. In
contrast, the methods herein discussed fit within the mergesort. The
idea is to convery information from one stage of the mergesort to the
next. Each stage is modified so that it can process the two subsorts
more efficiently for some patterns of input arrangements. One way of
drawing the contrast is that adaptive methods seek to adapt to patterns,
while information transfer conveys smaller-scale information outwards.
The merge stages do not ‘know’ anything about patterns, and faster
processing for certain large-scale patterns happens almost
‘accidentally’ from the perspective of the mechanistic merging. One task
of information transfer is to take the summarized information
transferred from the two inbound subsorts and condense it into a new
summary for a subsequent sort.</p>
<h2 data-number="2.3" id="beating-the-bound"><span
class="header-section-number">2.3</span> Beating the bound</h2>
<p>The bound on performance of comparison sorting cannot be broken.
However, it does not have quite the universal meaning one might take.
Let us put this succinctly.</p>
<blockquote>
<p>A change in algorithm performance that affects a vast set of cases
may have little impact on the average performance over a vastly vast set
of possibilities.</p>
</blockquote>
<p>The point is that improving the performance over a large set of
special-case patterns does not necessarily, from the perpective of
bounds, mean that the average performance be substantially degraded.
This is because <span class="math inline">\(N!\)</span> possible
arrangements is utterly vast. (We are assuming non-small sort problems,
such as when <span class="math inline">\(N&gt;1000\)</span>.)</p>
<p>That said, mergesort is very efficient, and so incorporating logic to
handle, even in an implicit manner, a set of patterns more speedily,
will almost inevitably degrade average performance, especially at early
small subsort stages.</p>
<h1 data-number="3" id="patterns-of-interest"><span
class="header-section-number">3</span> Patterns of interest</h1>
<p>At this point we outline the patterns that we will first discuss, and
later analyse. Some of this might seem ponderous, with excessive detail
for an early stage in the discussion. The rationale is that we do not
wish to duplicate part of the presentation later.</p>
<h2 data-number="3.1" id="main-patterns"><span
class="header-section-number">3.1</span> Main patterns</h2>
<!-- md-formatter off (Table misunderstood) -->
<table>
<caption>Two sorting task examples drawn as a sets of points. The
x-coordinates are the input indices, and the y-coordinates are the
output indices. The performance of comparison sorting algorithms do not
depend on the exact values, and only on relative values. Drawing (a)
illustrates the singular case where the data is presorted. Drawing (b)
is like this, but a small proportion of the members have been displaced.
This illustrates the scenario where the values of some members of a
previously-sorted dataset are updated, and the data is to be sorted
again.</caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="figs/four_by_four_presort.svg"
alt="4x4 random" /></td>
<td style="text-align: center;"><img
src="figs/four_by_four_presort_displace.svg" alt="4x4 random" /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<!-- md-formatter on -->
<p>We will represent sort tasks graphically as shown. We are not
concerned about the actual member values. Rather, we focus on the input
and output orderings. In these drawings the elements of the sort set are
shown as dots whose x-coordinate is given by the input-order index and
the y-coordinate is given by the output-order index. The figure shows
two such drawings. Plot (a) shows a task in which the entire set is
presorted: the input and output indices are the same. Plot (b) shows a
set of data that is mostly presorted but for which some members have
been displaced. This represents the scenario where a dataset has been
sorted but a proportion of members have been updated with new values. We
will in later analysis consider sorting performance as the proportion of
displacement is increased. Of particular importance is that performancy
does not degrade rapidly with small proportion of updates to member
values.</p>
<!-- md-formatter off (Table misunderstood) -->
<table>
<caption>Two sorting patterns. Plot (a) illustrates the task of merging
4 smaller presorted data sets that have been concatenated. Plot (b)
illustrates the task of sorting a presorted dataset after futher data
has been appended.</caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="figs/four_by_four_merge.svg"
alt="4x4 random" /></td>
<td style="text-align: center;"><img src="figs/four_by_four_append.svg"
alt="4x4 random" /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<!-- md-formatter on -->
<p>The next figure shows two common scenarios. Plot (a) illustrates the
task of merging separately-sorted datasets. A mergesort methods that
handles presorted data should perform well if, for example, the task is
to merge 4 presorted sets of equal size. Our analysis should consider
not only this but also scenarios where the number of sets to be merged
is not a power of 2, and where the sizes are not uniform. Plot (b)
illustrates the scenario where a previously sorted set is augmented with
new data. The new data is simply appended. If the number of new members
is proportionately small, the sort performance should be high.</p>
<p>We use the word <em>arrangement</em> to refer to a unique set of
input-output indices. It is analogous, if not synonymous, with
<em>permutation</em>. The plots are like permutation matrices with a dot
everywhere such a matrix contains a 1. We use <em>pattern</em> to refer
to a set of arrangements with a common structure. We can think of
patterns as general, parameterized by proportions and counts of
sub-patterns.</p>
<!-- md-formatter off (Table misunderstood) -->
<table>
<caption>Two sorting patterns. Plot (a) illustrates the case where data
has been coarsely sorted into groups and the task is to finish the sort.
Pattern (b) is similar, but the values of some members are displaced in
an attempt to approximate an imperfect presort, or another imprecise
grouping.</caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img
src="figs/four_by_four_diagonal.svg" alt="4x4 random" /></td>
<td style="text-align: center;"><img
src="figs/four_by_four_diagonal_displace.svg" alt="4x4 random" /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<!-- md-formatter on -->
<p>The next figure, plot (a), shows another key pattern. This is one
with grouped members. For example, the data may have been preprocessed
with a bucket sort. Scenarios that may present this kind of pattern are
less likely to have uniform sizes of sub-grouping, and so sort
performance should be evaluated more on uneven or otherwise
non-advantageous parameterizations.</p>
<h2 data-number="3.2" id="further-patterns"><span
class="header-section-number">3.2</span> Further patterns</h2>
<!-- md-formatter off (Table misunderstood) -->
<table>
<caption>Two sorting patterns in which the data arrives in groups but
without ordering between the groups. In (a) the groups are themselves
presorted, whereas in (b) they are not. Thus (b) illustrates a sort task
where data is strongly grouped.</caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="figs/four_by_four_forward.svg"
alt="4x4 random" /></td>
<td style="text-align: center;"><img src="figs/four_by_four_random.svg"
alt="4x4 random" /></td>
</tr>
<tr class="even">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;">(b)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<!-- md-formatter on -->
<p>Later we will extend our analysis to a few other patterns that
stretch the capabilities of sorting algorithms while arguably having
less application to common real-world scenarios. In the preceding
figure, plot (b), we apply the displacement process described earlier to
plot (a). This approximately simulates an imperfect grouped presort. The
illustrations of the next figure, plots (a) and (b), show random
blockwise patterns that mimick roughly grouped data.</p>
<h1 data-number="4" id="drawing-up-anchors"><span
class="header-section-number">4</span> Drawing up anchors</h1>
<h2 data-number="4.1" id="anchors-and-lozenges"><span
class="header-section-number">4.1</span> Anchors and lozenges</h2>
<p>As discussed earlier, the general approach to mergesort under
consideration involves the transfer of information from one stage to
another. We are combining this with ideas from DAGs of order-dimension
2. These ideas suggest what information might be profitably maintained
as the algorithm goes up the divide-and-conquer hierarchy. The ideas
also provide methods for updates with bounded performance
guarantees.</p>
<figure>
<img src="figs/standard_lozenge.svg"
alt="Specific dataset members, and chains of members, that we use to carry information from one mergesort stage to the next. The members are considered to be points with input and output indices as the x and y coordinatess. The head of the sort (the first member) is the “southernmost” member and the tail is the “northernmost”. We call the elements that are first and last in the unsorted data anchors. During our algorithms we often maintain chains of members as shown. One is the SW chain from W anchor to S head, selecting the most southerly member as the chain proceeds eastwards." />
<figcaption aria-hidden="true">Specific dataset members, and chains of
members, that we use to carry information from one mergesort stage to
the next. The members are considered to be points with input and output
indices as the x and y coordinatess. The head of the sort (the first
member) is the “southernmost” member and the tail is the “northernmost”.
We call the elements that are first and last in the unsorted data
<em>anchors</em>. During our algorithms we often maintain chains of
members as shown. One is the SW chain from W anchor to S head, selecting
the most southerly member as the chain proceeds eastwards.</figcaption>
</figure>
<p>The full information is illustrated in the figure. Elements that have
so far been sorted in one of the subsorts can be considered to be
vertices in a graph, each with a unique index and a value. The
illustration shows the process for a stable sort, thought for simplicity
one can think of unique values. The approach suggested by graphs of
order-dimension 2 is to record shrink-wrapped chains of vertices. We can
find these either working left and right across indices, or up and down
across values. We call the element with the lowest index the “west
anchor”, We scan through elements, forming two chains of elements with
the lowest and highest values encountered so far. Then we do the same
from the element with the highest index, that is the east anchor,
scanning down indices, forming two more chains. These chains form a kind
of lozenge shape.</p>
<!-- 1288 wide -->
<figure>
<img src="figs/TwoLozenge.jpg" style="width:2.86222in"
alt="Combining the chains from two subsorts. This illustration has left and right size-8 sorts. Since the left head precedes the right head, the combined SW chain is simply the left SW chain. Likewise the NE chain from the right becomes the combined chain because the right tail comes after the left tail The other two chains necessarily require splicing. The SE combined chain begins with the whole of the right SE chain. The part of the left SE chain after the right head is discarded and the remainder is appended to the end of the right SE chain. The ideas of posets of order-dimension 2 lead to the realization that the comparisons required are O(N). This is because we only test members in the left once in the whole sort for each discard, and once per chain join for retention." />
<figcaption aria-hidden="true">Combining the chains from two subsorts.
This illustration has left and right size-8 sorts. Since the left head
precedes the right head, the combined SW chain is simply the left SW
chain. Likewise the NE chain from the right becomes the combined chain
because the right tail comes after the left tail The other two chains
necessarily require splicing. The SE combined chain begins with the
whole of the right SE chain. The part of the left SE chain after the
right head is discarded and the remainder is appended to the end of the
right SE chain. The ideas of posets of order-dimension 2 lead to the
realization that the comparisons required are <span
class="math inline">\(O(N)\)</span>. This is because we only test
members in the left once in the whole sort for each discard, and once
per chain join for retention.</figcaption>
</figure>
<p>We learn from examination of DAGs of order-dimension 2 that we can
merge lozenges as mergesort unfolds. When we merge two subsorts we only
need traverse elements in the chains when they are removed. Consider the
SW chains of two subsorts, that is those that begin at their east
anchors and end at their south heads. The chain in the right subsort
remains unchanged, except that we need only append those elements in the
left subsort’s chain that come before the right south head in the sort.
The work we need to do is to find the cut, being potentially some part
beginning with the anchor being discarded and potentially some part (any
remaining) being appended. If we begin at the anchor and search for the
cut point from there, the overall number of comparisons is <span
class="math inline">\(O(N)\)</span>.</p>
<p>A key question, that is asnwered implicitly or explicitly, is where
the anchors lie relative to the ranges of the other subsort. That is, to
ask whether the left east anchor lies between the right head and tail,
or if it comes before or after. Likewise, we find the relative location
of the right west anchor relative to the left head, right head
range.</p>
<h2 data-number="4.2" id="anchor-comparisons"><span
class="header-section-number">4.2</span> Anchor comparisons</h2>
<p>Let us consider, in isolation, the task of comparing the anchor of
one subsort with the value range of another subsort, and performing the
same comparison with the subsort exchanged.</p>
<!-- 860px wide -->
<figure>
<img src="figs/AnchorRanges.jpg" style="width:1.91111in"
alt="Ranges of members in subsorts relative to key members. The process of combining the chains of two subsorts involves comparisons between the head and tail members of both sides. See the earlier figure. It involves comparisons between these and the left E anchor and right W anchor. Overall we make use of two ranges. On the left, the extent is that of all the data from head to tail, and dividing the range is the E anchor. We label values outside of this range as either before (B) or after (A), and we subdivide the range into upper (U) and lower (L) by the E anchor. A similar division of ranges of values on the right uses right subsort W anchor." />
<figcaption aria-hidden="true">Ranges of members in subsorts relative to
key members. The process of combining the chains of two subsorts
involves comparisons between the head and tail members of both sides.
See the earlier figure. It involves comparisons between these and the
left E anchor and right W anchor. Overall we make use of two ranges. On
the left, the extent is that of all the data from head to tail, and
dividing the range is the E anchor. We label values outside of this
range as either before (B) or after (A), and we subdivide the range into
upper (U) and lower (L) by the E anchor. A similar division of ranges of
values on the right uses right subsort W anchor.</figcaption>
</figure>
<!-- md-formatter off (Table misunderstood) -->
<table>
<caption>Where anchors can lie relative to ranges. The rows are for
locations of the left E anchor relative to the right ranges as
illustrated in the preceding figure. The row labelled <em>A</em> is for
cases in which the left anchor is sorted after the right tail. The
columns are for locations of the right W anchor relative to the left
subsort ranges. The table notes that it is not possible for the left
anchor to be after the right tail when the right anchor is after the
left tail. There are 8 possibilities. <em>(Formatting of this table is
limited by current versions of tooling.)</em></caption>
<colgroup>
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 33%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Left anchor, right interval</th>
<th style="text-align: center;">Right an- // A</th>
<th style="text-align: center;">chor, lef- // U+L</th>
<th style="text-align: center;">t interval // B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">A</td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">U+L</td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">B</td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
</tr>
</tbody>
</table>
<!-- md-formatter on -->
<!-- md-formatter off (Table misunderstood) -->
<table>
<caption>An expanded version of the preceding table, with the ranges
split by anchor. Algorithmically this addresses the question as to what
“happens” if we first compare the subsort anchors. If the left anchor
precedes the right anchor we narrow down to the 4 possibilities in the
intersection of rows L and B, and columns A and U. <em>(Formatting of
this table is limited by current versions of tooling.)</em></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 23%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Left anchor, right interval</th>
<th style="text-align: center;">Right a- // A</th>
<th style="text-align: center;">nchor, l- // U</th>
<th style="text-align: center;">eft int- // L</th>
<th style="text-align: center;">erval // B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">A</td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">U</td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">L</td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">B</td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\checkmark\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\times\)</span></td>
</tr>
</tbody>
</table>
<!-- md-formatter on -->
<p>This is illustrated. The left anchor (circle) may be above (A),
within (U+L) or below (B) the range of values in the right subsort.
There are three possibilities for the two cases, giving nine in total,
but two are immediately impossible. The tricky aspect of approaching
this as a sequence of comparisons, which is what our overall problem
statement constrains us to do, is that there is no real symmetry. The 7
valid possibilities are shown in the first table. At least 3 comparisons
will be required. We can introduce symmetry by first comparing anchors.
Then each anchor is placed in one of four ranges, splitting the
within-range into upper (U) and lower (L) relative to the other anchor.
This expands the combinations to 16. However, as shown in the second
table, only 8 are possible. Comparing anchor values first distinguishes
between the top-left and bottom-right 4, and exactly 3 comparisons are
required overall. Actually not quite: if either anchor is at its
subsort’s head or tail, either the second or third can be elided.</p>
<h2 data-number="4.3" id="way-sort"><span
class="header-section-number">4.3</span> 4-way sort</h2>
<!-- 2876px wide -->
<figure>
<img src="figs/TwentyFour.jpg" style="width:4.79333in"
alt="Half of the arrangements for size-4 merge for left anchor &gt; right anchor. The first number shows, for each case, the number of comparisons required in the classic sort. The total is 4\times 4 + 8\times 5 = 56 = 24+32. The sort using anchor predicates has total comparisons 58, since one case is reduced to 3 and one increased to 6, and one increased from 5 to 6. The expensive case (4 to 6) is really, after the 2 subsort comparisons, n/2=2 for the classic sort, and 3+n/4 using anchor comparisons, both on average for random arrangements." />
<figcaption aria-hidden="true">Half of the arrangements for size-4 merge
for left anchor &gt; right anchor. The first number shows, for each
case, the number of comparisons required in the classic sort. The total
is <span class="math inline">\(4\times 4 + 8\times 5 = 56 =
24+32\)</span>. The sort using anchor predicates has total comparisons
<span class="math inline">\(58\)</span>, since one case is reduced to 3
and one increased to 6, and one increased from 5 to 6. The expensive
case (4 to 6) is really, after the 2 subsort comparisons, <span
class="math inline">\(n/2=2\)</span> for the classic sort, and <span
class="math inline">\(3+n/4\)</span> using anchor comparisons, both on
average for random arrangements.</figcaption>
</figure>
<p>The first two stages in the hierarchy of a mergesort deserve special
attention. Specifically let us consider the merging of two sorted pairs
that complete a 4-way sort. First let us assume that we begin the second
stage by comparing the anchors from the pair subsorts. We can divide the
arrangements into sets according to the results, and only consider one.
The 12 arrangements arising when the right west anchor sorts ahead of
the left east anchor are shown in the figure. If the data is uniformly
scrambled, the optimal total count of comparisons is <span
class="math display">\[ \lceil 12 \log_2(24)\rceil = 56 . \]</span>
Perhaps surprisingly, mergesort in classic form achieves this, requiring
4 comparisons for 4 arrangements and 5 comparisons for 8
arrangements.</p>
<p>The comparisons required if we find and use anchor comparisons is
more complex. Consider the arrangements laid out in the figure.
Arrangement A only requires 3 comparisons, one for each of the pair
subsorts, and the comparison between the 2 anchors. In cases B, C and D
we do not need separate comparisons for the left anchor against the
right head and tail, but we need 1 between the left head and right
anchor. So that is 4 comparisons before actually merging. Then, during
merge, arrangements C and D require the initial comparison between left
and right heads, totalling 5 comparisons. The arrangements E, F and G
are analogous, and are <span class="math inline">\(180^\circ\)</span>
rotations of B, C and D.</p>
<p>The remaining arrangements are more elaborate, and involve more
comparisons than the classic sort. Arrangement I involves a comparison
between the left head and right tail, and does not use the comparison
between the anchor values. Arrangement H also does not use left anchor
and right tail. More than that, K is strictly inefficient in that we
compare the left head and right tail, but we <em>should</em> know that
given that we have to compare the two tails.</p>
<p>In summary, this approach requires 59 comparisons to sort 4 values.
Some of the increase is inefficiency. However some, in the manner of
Huffman (or other variable-length) codes, arises as we increase the
efficiency with presorted data, and similar patterns for larger
sorts.</p>
<h1 data-number="5" id="vector-divide-and-conquer"><span
class="header-section-number">5</span> Vector divide-and-conquer</h1>
<!-- 1588px wide -->
<figure>
<img src="figs/DivideAndConquer.jpg" style="width:2.52889in"
alt="Outline of divide-and-conquer for a size-16 sort that completes work in one locality. This is as opposed to, say, performing all size-4 subsorts before larger stages. In step 0 we sort [0,2), then [2,4), [0,4), and so on. The half-open interval indices are shown as range index values." />
<figcaption aria-hidden="true">Outline of divide-and-conquer for a
size-16 sort that completes work in one locality. This is as opposed to,
say, performing all size-4 subsorts before larger stages. In step 0 we
sort <span class="math inline">\([0,2)\)</span>, then <span
class="math inline">\([2,4)\)</span>, <span
class="math inline">\([0,4)\)</span>, and so on. The half-open interval
indices are shown as <em>range index</em> values.</figcaption>
</figure>
<p>Since mergesorting is performed in stages, and since we implemented
experiments on vector data, we wrote a non-recursive iterator. This
provides a convenient means to organize work. The figure show the steps
involved in sorting a vector of 16 elements. The ranges for the merges
in each step are shown in the table below. In each step a full range
results from merging two subsorts, one with range <span
class="math inline">\([\text{midpoint} - \text{extent},
\text{midpoint})\)</span>, and the other with range <span
class="math inline">\([\text{midpoint} , \text{midpoint} +
\text{extent})\)</span>. The table shows manipulation for u8 data type.
Typically a larger datatype would be used. We found it simplest to
implement the maximum size sort and use a subset. For u8 that means (a)
a size-256 sort (255 steps), (b) seeding with the final step of a
size-256 sort, shown as step -1 in the table, and (c) just using the
first 15 steps for, say, a size-16 sort. (Note, on a point of fine
detail, that there is a slight difference between the step -1 and step
254 in the negation pattern.)</p>
<!-- md-formatter off (Table misunderstood) -->
<table style="width:100%;">
<caption>The calculated information required for the 15 steps of a
size-16 mergesort. For each step, numbered in the first column, the
half-open range for the sort is shown in the second column. The
remaining columns show how we implemented the calculation of these
ranges, and are described in the main text. <em>(Typesetting
limitations, note for future: Prefer line between -1 and 0 and 14 and
15.)</em></caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 13%" />
<col style="width: 10%" />
<col style="width: 6%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Ste</th>
<th style="text-align: left;">Range</th>
<th style="text-align: left;">mid<span
class="math inline">\(\pm\)</span>extent</th>
<th style="text-align: left;">mid</th>
<th style="text-align: right;">extent</th>
<th style="text-align: center;">return</th>
<th style="text-align: right;">negation</th>
<th style="text-align: right;">mask</th>
<th style="text-align: right;">xor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><span
class="math inline">\(1000\,0000\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(1000\,0000\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1000\,0000\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;"><span
class="math inline">\([0,2)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1\pm
1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}-4-2-1\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;"><span
class="math inline">\([2,4)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(3\pm
1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}-4-2+1\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1110\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;"><span
class="math inline">\(\;\;[0,4)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\;\;2\pm
2\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}-4-2\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0010\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1110\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1110\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;"><span
class="math inline">\([4,6)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(5\pm
1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}-4+2-1\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1101\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(11\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;"><span
class="math inline">\([6,8)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(7\pm
1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}-4+2+1\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1100\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;"><span
class="math inline">\(\;\;[4,8)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\;\;6\pm
2\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}-4+2\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0010\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1100\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1110\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;"><span
class="math inline">\(\;\;\;\;[0,8)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\;\;\;\;4\pm
4\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}-4\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0100\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1100\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1100\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;"><span
class="math inline">\([8,10)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(9\pm
1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}+4-2-1\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1011\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(111\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;"><span
class="math inline">\([10,12)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(11\pm
1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}+4-2+1\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1010\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;"><span
class="math inline">\(\;\;[8,12)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\;\;10\pm
2\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}+4-2\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0010\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1010\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1110\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;"><span
class="math inline">\([12,14)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(13\pm
1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}+4+2-1\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1001\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(11\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;"><span
class="math inline">\([14,16)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(15\pm
1\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}+4+2+1\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1000\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;"><span
class="math inline">\(\;\;[12,16)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\;\;14\pm
2\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}+4+2\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0010\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1000\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1110\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: left;"><span
class="math inline">\(\;\;\;\;[8,16)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\;\;\;\;12\pm
4\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}+4\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0100\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1000\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1100\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: left;"><span
class="math inline">\(\;\;\;\;\;\;[0,16)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\;\;\;\;\;\;8\pm 8\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(\{8\}\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,1000\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,1000\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1000\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0001\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\circ\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(0111\,0111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\,1111\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1111\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span
class="math inline">\(\vdots\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">253</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><span
class="math inline">\(0100\,0000\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0100\,0000\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1100\,0000\)</span></td>
<td style="text-align: right;">—</td>
</tr>
<tr class="even">
<td style="text-align: right;">254</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><span
class="math inline">\(1000\,0000\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"><span
class="math inline">\(0000\,0000\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(1000\,0000\)</span></td>
<td style="text-align: right;">—</td>
</tr>
</tbody>
</table>
<!-- md-formatter on -->
<p>The key concept employed in our chosen algorithm is that the
mid-points for ranges are expressed consistently as <span
class="math inline">\(\pm\)</span> switches. For example, the first step
has mid-point = 1, but we express this as <span class="math display">\[1
= 8-4-2-1.\]</span> We go further when embedding in a size-256 sort.
That is, using notation in common with the table, <span
class="math display">\[1=128-64-32-16-8-4-2-1 =
\{8\}-4-2-1.\]</span></p>
<p>The algorithm is then designed in logical steps.</p>
<ul>
<li>The side extents are powers of two. At each step we either shift the
previous extent one bit higher or return to an extent of 1.</li>
<li>The mid-point is calculated by adding or subtracting powers of 2
down to the new extent. A negation pattern specifies which bit positions
are negated, and a mask eliminates the lowest bits.</li>
<li>We can determine when we need to return the extent to 1 by checking
to see if the bitwise AND of the previous extent and negation pattern is
non-zero.</li>
<li>The negation pattern is only changed when the extent is returned to
1. The necessary change is a bitwise XOR with a pattern, shown in the
last column in the table. This pattern is iteself a bitwise XOR of the
previous extent, with <span
class="math inline">\((\text{extent}-1)\)</span>.</li>
<li>The mask is the two’s complement negation of the extent. We chose to
use unsigned arithmetic, so we find the mask by adding 1 to the bitwise
NOT of the extent.</li>
</ul>
<p>For sort sizes that are not powers of 2, the sequence must be
appropriately truncated. We have not examined this thoroughly. It is
actually only necessary to look at the mid-oint, and otherwise we can
just truncate the upper range to the size. Our current method is to
check to see if the mid-point is within range (leaves any range above
it) and if not, shift the extent up to the next power of two and
recalculate the mid-point. Since we then proceed to the next step, that
step can return the extent to 1. Crudely this might mean <span
class="math inline">\(O(\log(N^2))\)</span> maximum work. However, it
may be provable that for each time a bit shift happens more than once at
a lower shirt position, one at a higher level is necessarily not
skipped. This might mean that the work is maximally proportional to
<span class="math inline">\(\lceil\log_2(N)\rceil\)</span>.</p>
<h1 data-number="6" id="dags-of-order-dimension-2"><span
class="header-section-number">6</span> DAGs of order-dimension 2</h1>
<h2 data-number="6.1" id="concepts"><span
class="header-section-number">6.1</span> Concepts</h2>
<p>The project discussed here originated as a side project of a side
project. The thread connecting these is partially ordered sets of
order-dimension 2, along with dominance drawings. Let us review
these.</p>
<p>A good starting point is st-planar graphs that are transitively
irreducible. An st-planar graph is a DAG with one external source and
one external sink, and without crossings. Transitive reduction is the
removal of edges that are not needed for reachability. That is to say,
if vertex B can be reached from A and C from B, then we remove any edges
from A to C, since C is transitively reachable from A. We say that a DAG
is transitively irreducible if no edges can be removed by transitive
reduction.</p>
<p>The vertices of st-planar graphs form a partially ordered set. If we
number the edges by depth-first search (DFS) in two ways, we can use the
numerings as coordinates in a plane such that one vertex is reachable
from another if and only if it is placed above and to the right. The two
DFSs are executed by either visiting the leftmost of rightmost children
first. Conversely, we can begin with the coordinates from the two DFSs
and place them in a drawing, called a <em>dominance</em> drawing. We can
recover the edges by adding edges between vertices that are reachable by
the rule of above and to the right, and not add edges that would be
removed by transitive reduction. The graph will be correctly recovered
by this procedure if and only iff the vertices form a poset of
order-dimension 2.</p>
<h2 data-number="6.2" id="sorting-as-a-task-in-dominance-drawing"><span
class="header-section-number">6.2</span> Sorting as a task in dominance
drawing</h2>
<p>The task of comparison sorting is much like the task of placing
vertices in a dominance drawing. It is as if we have been given the
x-coordinates as a contiguous set of integers, and we can compare the
relative y-coordinate location of any two vertices.</p>
<p>One interesting perspective on comparison sorting is that it is an
implied task within dominance drawing construction. In other words, any
algorithm that constructs the dominance drawing of a set of values
necessarily sorts those values. Equally, every sort task can be
represented by a DAG of order-dimension 2. Now, the two coordinates for
the vertices are obtained as the children-after-parents sequence of
vertex visitations ina DFS. Therefore we may try to find algorithms that
exploit properties of the graph. We might, for example, expect that we
can construct dominance drawings more efficiently when the graph is
planar or a tree.</p>
<h2 data-number="6.3" id="tree-edge-construction"><span
class="header-section-number">6.3</span> Tree-edge construction</h2>
<p>Using knowledge of one coordinate, and the ability to do pairwise
comparisons of the other coordinates (via values, which have the
ordering), it is possible to construct one of the DFS trees. More
generally, it is possible to identify all the leftmost (or all the
rightmost) parents of every vertex. Equally one can identify all the
rightmost (or all the leftmost) children. The simplest version of this
process is a sequential sweep. However, since we are interested in
mergesorts with their divide-and-conquer approach, we describe a
block-merge step.</p>
<p>Consider a completed block, that is a set of vertices, contiguous in
the x-coordinates. By <em>complete</em> we mean that all vertices with
parent internally in the block are connected to it, and that the
leftmost parent is connected. Suppose that we wish to merge the block
with a similar one to the left. The only vertices in the right block
that connect with those in the left are the unparented ones. So we need
to maintain a chain of these. This chain is the SW chain in the
lozenge.</p>
<p>Scan through the vertices in the left block, from right to left.
Mainly those in the SE chain in the lozenge will be leftmost parents.
This is because transitive reduction means that mostly those in the NE
and SE chain will be parents. Further, the rightmost vertex in the left
block will be a parent more to the left of any in the others in the NE
chain. Thus basic st-planar graphs can be constructed mostly traversal
of the left block’s SE chain and the right block’s SW chain.</p>
<!-- 2520px wide -->
<figure>
<img src="figs/FrontMerge.jpg" style="width:4.2in"
alt="An illustration of how transitive reduction simplifies, fairly generally, maintenance of a front, that is a set of leaf or root vertices. The task illustrated is for merging of two sets of vertices and maintaining the set of most-SE vertices, which are, incidentally, leaves in a co-dominance graph. The left drawing has populated regions U, V and W where U+V is the set of vertices for which there are no vertices to the S and E. When we combine with a block of vertices on the right, the vertices in the front T are to the S and E of those in U. Therefore the combined front is T+V." />
<figcaption aria-hidden="true">An illustration of how transitive
reduction simplifies, fairly generally, maintenance of a front, that is
a set of leaf or root vertices. The task illustrated is for merging of
two sets of vertices and maintaining the set of most-SE vertices, which
are, incidentally, leaves in a co-dominance graph. The left drawing has
populated regions U, V and W where U+V is the set of vertices for which
there are no vertices to the S and E. When we combine with a block of
vertices on the right, the vertices in the front T are to the S and E of
those in U. Therefore the combined front is T+V.</figcaption>
</figure>
<p>This algorithm enables us to construct one DFS tree. If the DAG is a
tree, then one DFS tree can be found from the other by reordering
children. Maintaining the SE and SW chains is relatively straightforward
task. The aforementioned traversal is like a mergesort of the two chains
beginning at the anchor points, and this ends when one of the chains is
exhausted. Without loss of generality assume that the SW chain of the
right block is exhausted. In this case the following apply.</p>
<ul>
<li>The bottom of the right block is higher than that of the left block.
Equivalently, the beginning of the left-sorted data comes before the
beginning of the right.</li>
<li>The SW chain of the connected (merged) blocks is simply the SW chain
of the left block.</li>
<li>The trailing part of the SE chain of the right block, as illustrated
in the figure. The lengthened chain is the combined block’s SE
chain.</li>
<li>During traversal of the left SE and right SW chains, there is 1
comparison for each removed vertex, resulting in <span
class="math inline">\(N\)</span> comparisons in total over a full
sort.</li>
</ul>
<h1 data-number="7" id="analysis"><span
class="header-section-number">7</span> Analysis</h1>
<h2 data-number="7.1" id="implementation"><span
class="header-section-number">7.1</span> Implementation</h2>
<p>For this project we implemented three versions of mergesort. The
approach in all cases was to minimize comparisons. Other matters of
efficiency were largely disregarded. Furthermore, the modified
mergesorts made much use of auxiliary data structures. The three
versions were as follows.</p>
<ol type="1">
<li><p>Classic mergesort.</p></li>
<li><p>“Skipless” mergesort. This is much like mergesort, but one that
uses anchor points and the comparison strategies set out in the 4-way
sort section above. This accelerates for simple sequential patterns,
specifically when an anchor equals a head or tail. This also creates and
maintains the chains. What it does not do is the use the chains to skip
work.</p></li>
<li><p>“Pure” (elaborated) mergesort. This is like the <em>skipless</em>
mergesort, but uses the chains to skip work. We did not explore the best
strategies for skipping. Maintenance of chains is rather more
complicated and expensive when skipping. We used the methods outlined
earlier that are <span class="math inline">\(O(N)\)</span>-bounded.</p>
<p>Perhaps not surprisingly, the skipless method is generally more
efficient than the pure method for small sort stages. The more expensive
bookkeeping of the pure method is not offset by benefits of skipping
work. Even in later stages the pure method introduces costs such that it
is a bit more expensive over uniformly random input
arrangements.</p></li>
</ol>
<p>We present results below for the three methods, along with a blend
that uses the skipless method for the smaller subsorts and switches to
the pure methods for subsequent larger sorts. Since the skipless method
maintains the chains, this switch is seamless.</p>
<h2 data-number="7.2" id="results"><span
class="header-section-number">7.2</span> Results</h2>
<h3 data-number="7.2.1" id="uniformly-random-arrangements"><span
class="header-section-number">7.2.1</span> Uniformly random
arrangements</h3>
<table>
<caption>Counts, averaged over uniformly random arrangements, of
comparisons made in size-4096 sorts. Results are shown for classic
mergesort, for the skipless experimental method, and the pure
experimental method. For the pure method we show the raw average counts,
totalled across all subsorts, in each stage (subsort size). All other
results are shown normalized by the sort size. The columns in format
“<span class="math inline">\(a+b\)</span>” show an attempt to split the
counts into comparisons required for bookkeeping (<span
class="math inline">\(a\)</span>), and other counts required for merging
subsorts (<span class="math inline">\(b\)</span>). For the most part the
reader is likely to disregard these. The final column shows the blended
sort that uses the skipless method for the first 4 stages and the pure
method for higher stages.</caption>
<colgroup>
<col style="width: 5%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 5%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 5%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">Classic …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">Skipless …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">Pure …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">Blend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0+2048.0</td>
<td style="text-align: right;">0.000+0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.0+2048.0</td>
<td style="text-align: right;">0.000+0.500</td>
<td style="text-align: right;"><strong>0.500</strong></td>
<td style="text-align: right;">0.0+2048.0</td>
<td style="text-align: right;">0.000+0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0+2730.8</td>
<td style="text-align: right;">0.000+0.667</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">1536.5+1448.6</td>
<td style="text-align: right;">0.375+0.354</td>
<td style="text-align: right;"><strong>0.729</strong></td>
<td style="text-align: right;">2389.7+1364.0</td>
<td style="text-align: right;">0.583+0.333</td>
<td style="text-align: right;">0.916</td>
<td style="text-align: right;">0.729</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0+3273.7</td>
<td style="text-align: right;">0.000+0.799</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">1152.6+2677.0</td>
<td style="text-align: right;">0.281+0.654</td>
<td style="text-align: right;"><strong>0.935</strong></td>
<td style="text-align: right;">1808.0+2571.4</td>
<td style="text-align: right;">0.441+0.628</td>
<td style="text-align: right;">1.069</td>
<td style="text-align: right;">0.935</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.0+3639.7</td>
<td style="text-align: right;">0.000+0.889</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">671.6+3445.0</td>
<td style="text-align: right;">0.164+0.841</td>
<td style="text-align: right;"><strong>1.005</strong></td>
<td style="text-align: right;">1091.6+3444.4</td>
<td style="text-align: right;">0.267+0.841</td>
<td style="text-align: right;">1.107</td>
<td style="text-align: right;">1.005</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.0+3855.5</td>
<td style="text-align: right;">0.000+0.941</td>
<td style="text-align: right;">0.941</td>
<td style="text-align: right;">360.2+3799.9</td>
<td style="text-align: right;">0.088+0.928</td>
<td style="text-align: right;">1.016</td>
<td style="text-align: right;">635.1+3956.9</td>
<td style="text-align: right;">0.155+0.966</td>
<td style="text-align: right;"><strong>1.121</strong></td>
<td style="text-align: right;">1.121</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.0+3972.0</td>
<td style="text-align: right;">0.000+0.970</td>
<td style="text-align: right;">0.970</td>
<td style="text-align: right;">186.4+3957.3</td>
<td style="text-align: right;">0.046+0.966</td>
<td style="text-align: right;">1.012</td>
<td style="text-align: right;">362.9+4164.1</td>
<td style="text-align: right;">0.089+1.017</td>
<td style="text-align: right;"><strong>1.105</strong></td>
<td style="text-align: right;">1.105</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.0+4033.7</td>
<td style="text-align: right;">0.000+0.985</td>
<td style="text-align: right;">0.985</td>
<td style="text-align: right;">94.4+4029.8</td>
<td style="text-align: right;">0.023+0.984</td>
<td style="text-align: right;">1.007</td>
<td style="text-align: right;">202.3+4205.6</td>
<td style="text-align: right;">0.049+1.027</td>
<td style="text-align: right;"><strong>1.076</strong></td>
<td style="text-align: right;">1.076</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.0+4063.8</td>
<td style="text-align: right;">0.000+0.992</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: right;">47.8+4062.7</td>
<td style="text-align: right;">0.012+0.992</td>
<td style="text-align: right;">1.004</td>
<td style="text-align: right;">113.1+4192.9</td>
<td style="text-align: right;">0.028+1.024</td>
<td style="text-align: right;"><strong>1.051</strong></td>
<td style="text-align: right;">1.051</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.0+4079.8</td>
<td style="text-align: right;">0.000+0.996</td>
<td style="text-align: right;">0.996</td>
<td style="text-align: right;">23.9+4079.5</td>
<td style="text-align: right;">0.006+0.996</td>
<td style="text-align: right;">1.002</td>
<td style="text-align: right;">62.0+4167.1</td>
<td style="text-align: right;">0.015+1.017</td>
<td style="text-align: right;"><strong>1.033</strong></td>
<td style="text-align: right;">1.033</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.0+4088.2</td>
<td style="text-align: right;">0.000+0.998</td>
<td style="text-align: right;">0.998</td>
<td style="text-align: right;">12.0+4088.2</td>
<td style="text-align: right;">0.003+0.998</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">33.8+4141.9</td>
<td style="text-align: right;">0.008+1.011</td>
<td style="text-align: right;"><strong>1.019</strong></td>
<td style="text-align: right;">1.019</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.0+4092.2</td>
<td style="text-align: right;">0.000+0.999</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">6.0+4092.1</td>
<td style="text-align: right;">0.001+0.999</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">17.7+4123.6</td>
<td style="text-align: right;">0.004+1.007</td>
<td style="text-align: right;"><strong>1.011</strong></td>
<td style="text-align: right;">1.011</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.0+4094.1</td>
<td style="text-align: right;">0.000+1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">3.0+4094.1</td>
<td style="text-align: right;">0.001+1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">9.7+4113.2</td>
<td style="text-align: right;">0.002+1.004</td>
<td style="text-align: right;"><strong>1.007</strong></td>
<td style="text-align: right;">1.007</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">0.0+43971.3</td>
<td style="text-align: right;">0.000+10.735</td>
<td style="text-align: right;">10.735</td>
<td style="text-align: right;">4094.5+41822.3</td>
<td style="text-align: right;">1.000+10.211</td>
<td style="text-align: right;">11.210</td>
<td style="text-align: right;">6726.2+42493.0</td>
<td style="text-align: right;">1.642+10.374</td>
<td style="text-align: right;">12.016</td>
<td style="text-align: right;">11.592</td>
</tr>
</tbody>
</table>
<p>The performance averaged over uniformly random arrangements are shown
in the first results table. The sort size for the majority of the
experiments is 4096, and the results are averaged over at least 100
runs. In this table only we show in the first results column the average
counts of comparisons. Thereafter we normalize by 4096, so a final tally
of <span class="math inline">\(12.0\)</span> would correspond to exactly
<span class="math inline">\(N\log_2(N)\)</span> comparisons for this
sort size. Mainly for reasons of diagnostics and experimental
exploration, results are shown as the sum of two components. This is to
say we categorized each comparison as either (a) being required for
maintenance of chains or anchor information, or (b) being otherwise part
of the subsort merge process.</p>
<h3 data-number="7.2.2" id="main-patterns-1"><span
class="header-section-number">7.2.2</span> Main patterns</h3>
<table>
<caption>Counts of comparisons for input arrangements that are
presorted, or nearly so. Experiments were much like those in the
preceding results table. The results for classic, skipless and pure
methods are here presented in groups rows with classic method at the
top. Total counts are shown at the bottom. The first column is for
presorted data, with a single arrangement for the pattern. For
subsequent experiments the values of a percentage of members, randomly
selected are updated (displaced).</caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">Presort …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">0.3% …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">1% …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">3% …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">10% …</th>
<th style="text-align: right;">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.501</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.000 + 0.505</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">0.000 + 0.515</td>
<td style="text-align: right;">0.515</td>
<td style="text-align: right;">0.000 + 0.547</td>
<td style="text-align: right;">0.547</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.503</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.000 + 0.510</td>
<td style="text-align: right;">0.510</td>
<td style="text-align: right;">0.000 + 0.529</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">0.000 + 0.590</td>
<td style="text-align: right;">0.590</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.811</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">0.000 + 0.907</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">0.000 + 0.964</td>
<td style="text-align: right;">0.964</td>
<td style="text-align: right;">0.000 + 0.991</td>
<td style="text-align: right;">0.991</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.852</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.000 + 0.956</td>
<td style="text-align: right;">0.956</td>
<td style="text-align: right;">0.000 + 0.986</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">0.000 + 0.996</td>
<td style="text-align: right;">0.996</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;"><strong>0.500</strong></td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.003 + 0.251</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.011 + 0.253</td>
<td style="text-align: right;"><strong>0.264</strong></td>
<td style="text-align: right;">0.033 + 0.257</td>
<td style="text-align: right;">0.290</td>
<td style="text-align: right;">0.105 + 0.274</td>
<td style="text-align: right;">0.378</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.003 + 0.130</td>
<td style="text-align: right;">0.133</td>
<td style="text-align: right;">0.009 + 0.140</td>
<td style="text-align: right;"><strong>0.150</strong></td>
<td style="text-align: right;">0.027 + 0.171</td>
<td style="text-align: right;">0.198</td>
<td style="text-align: right;">0.084 + 0.268</td>
<td style="text-align: right;">0.353</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.001 + 0.666</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.001 + 0.894</td>
<td style="text-align: right;">0.896</td>
<td style="text-align: right;">0.001 + 0.964</td>
<td style="text-align: right;">0.965</td>
<td style="text-align: right;">0.001 + 0.990</td>
<td style="text-align: right;">0.992</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.001 + 0.852</td>
<td style="text-align: right;">0.853</td>
<td style="text-align: right;">0.001 + 0.956</td>
<td style="text-align: right;">0.956</td>
<td style="text-align: right;">0.001 + 0.986</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: right;">0.001 + 0.996</td>
<td style="text-align: right;">0.996</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.005 + 0.251</td>
<td style="text-align: right;">0.256</td>
<td style="text-align: right;">0.017 + 0.253</td>
<td style="text-align: right;">0.270</td>
<td style="text-align: right;">0.051 + 0.257</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.163 + 0.273</td>
<td style="text-align: right;">0.436</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.005 + 0.129</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">0.015 + 0.138</td>
<td style="text-align: right;">0.153</td>
<td style="text-align: right;">0.044 + 0.164</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">0.135 + 0.249</td>
<td style="text-align: right;">0.384</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.004 + 0.072</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">0.014 + 0.095</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.040 + 0.153</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">0.115 + 0.314</td>
<td style="text-align: right;">0.429</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.004 + 0.052</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.013 + 0.098</td>
<td style="text-align: right;"><strong>0.112</strong></td>
<td style="text-align: right;">0.038 + 0.206</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">0.102 + 0.420</td>
<td style="text-align: right;">0.522</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.004 + 0.060</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.016 + 0.147</td>
<td style="text-align: right;"><strong>0.162</strong></td>
<td style="text-align: right;">0.045 + 0.304</td>
<td style="text-align: right;">0.349</td>
<td style="text-align: right;">0.091 + 0.510</td>
<td style="text-align: right;">0.601</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.006 + 0.097</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">0.018 + 0.231</td>
<td style="text-align: right;"><strong>0.250</strong></td>
<td style="text-align: right;">0.056 + 0.411</td>
<td style="text-align: right;">0.468</td>
<td style="text-align: right;">0.072 + 0.606</td>
<td style="text-align: right;">0.678</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.008 + 0.163</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">0.035 + 0.337</td>
<td style="text-align: right;"><strong>0.372</strong></td>
<td style="text-align: right;">0.061 + 0.520</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.052 + 0.736</td>
<td style="text-align: right;">0.789</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.024 + 0.263</td>
<td style="text-align: right;">0.287</td>
<td style="text-align: right;">0.056 + 0.447</td>
<td style="text-align: right;"><strong>0.504</strong></td>
<td style="text-align: right;">0.060 + 0.650</td>
<td style="text-align: right;">0.710</td>
<td style="text-align: right;">0.046 + 0.887</td>
<td style="text-align: right;">0.933</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.055 + 0.370</td>
<td style="text-align: right;">0.426</td>
<td style="text-align: right;">0.084 + 0.598</td>
<td style="text-align: right;"><strong>0.682</strong></td>
<td style="text-align: right;">0.068 + 0.831</td>
<td style="text-align: right;">0.899</td>
<td style="text-align: right;">0.046 + 0.955</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.093 + 0.485</td>
<td style="text-align: right;">0.577</td>
<td style="text-align: right;">0.121 + 0.770</td>
<td style="text-align: right;"><strong>0.891</strong></td>
<td style="text-align: right;">0.072 + 0.921</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: right;">0.018 + 0.984</td>
<td style="text-align: right;">1.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.229 + 0.668</td>
<td style="text-align: right;">0.897</td>
<td style="text-align: right;">0.083 + 0.897</td>
<td style="text-align: right;"><strong>0.980</strong></td>
<td style="text-align: right;">0.029 + 0.966</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.009 + 0.993</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">0.000 + 6.000</td>
<td style="text-align: right;">6.000</td>
<td style="text-align: right;">0.000 + 7.226</td>
<td style="text-align: right;"><strong>7.226</strong></td>
<td style="text-align: right;">0.000 + 8.024</td>
<td style="text-align: right;"><strong>8.024</strong></td>
<td style="text-align: right;">0.000 + 8.842</td>
<td style="text-align: right;">8.842</td>
<td style="text-align: right;">0.000 + 9.698</td>
<td style="text-align: right;">9.698</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Skipless</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.023 + 3.664</td>
<td style="text-align: right;"><strong>3.687</strong></td>
<td style="text-align: right;">0.063 + 5.232</td>
<td style="text-align: right;"><strong>5.295</strong></td>
<td style="text-align: right;">0.154 + 6.737</td>
<td style="text-align: right;">6.892</td>
<td style="text-align: right;">0.382 + 8.337</td>
<td style="text-align: right;">8.719</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pure</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.437 + 3.111</td>
<td style="text-align: right;"><strong>3.548</strong></td>
<td style="text-align: right;">0.473 + 4.512</td>
<td style="text-align: right;"><strong>4.985</strong></td>
<td style="text-align: right;">0.565 + 5.884</td>
<td style="text-align: right;">6.449</td>
<td style="text-align: right;">0.849 + 7.427</td>
<td style="text-align: right;">8.276</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blend</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.432 + 3.113</td>
<td style="text-align: right;"><strong>3.545</strong></td>
<td style="text-align: right;">0.456 + 4.518</td>
<td style="text-align: right;"><strong>4.974</strong></td>
<td style="text-align: right;">0.514 + 5.904</td>
<td style="text-align: right;">6.418</td>
<td style="text-align: right;">0.692 + 7.493</td>
<td style="text-align: right;">8.185</td>
</tr>
</tbody>
</table>
<p>We chose, as described earlier, to analyse some patterns that we
conjectured might appear in real use cases. Results for the pattern that
amounts to sorting presorted data are shown in the second results table.
In this and subsequent tables the results are shown with results for
classic mergesort in the first rows, the skipless method in the second
set of rows, the full pure results in the third set of rows, with
summary totals at the bottom. The first columns show the results for
exactly presorted input data. Remaining columns are for the case, with
increasing proportion, were the values of a small number of presorted
members are replaced by new values. Thus we assess the performance on
the task of updating an existing sort. All algorithms should behave
well, which means that their performance remains good for a very small
proportion of updates. Inevitably, as the percentage increases, the
performance should tend towards the uniformly random task. We show <span
class="math inline">\(10\%\)</span> to test this trend, but that would
be a large update for a large dataset in real scenarios.</p>
<table>
<caption>Counts for experiments, and with presentation, much like those
for the preceding table . In these experiments the patterns correspond
to merging of 2 or more presorted subsorts of subsets of data. For the
first four presented experiments the subsorts were of equal size. For
the last experiment there were 4 subsorts with sizes in the ratios <span
class="math inline">\(3:5:4:5\)</span>.</caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">Merge of 2 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">of 4 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">of 15 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">of 16 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">Uneven …</th>
<th style="text-align: right;">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.502</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.998</td>
<td style="text-align: right;">0.998</td>
<td style="text-align: right;">0.000 + 0.998</td>
<td style="text-align: right;">0.998</td>
<td style="text-align: right;">0.000 + 0.647</td>
<td style="text-align: right;"><strong>0.647</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;"><strong>0.500</strong></td>
<td style="text-align: right;">0.000 + 0.999</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">0.000 + 0.999</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">0.000 + 0.999</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">0.000 + 0.999</td>
<td style="text-align: right;"><strong>0.999</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;"><strong>1.000</strong></td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 0.999</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;"><strong>1.000</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.005 + 0.252</td>
<td style="text-align: right;">0.257</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.001 + 0.250</td>
<td style="text-align: right;">0.252</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;"><strong>0.001</strong></td>
<td style="text-align: right;">0.003 + 0.997</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.002 + 0.998</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.001 + 0.522</td>
<td style="text-align: right;"><strong>0.523</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;"><strong>0.000</strong></td>
<td style="text-align: right;">0.001 + 0.999</td>
<td style="text-align: right;"><strong>1.000</strong></td>
<td style="text-align: right;">0.001 + 0.999</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.001 + 0.999</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.001 + 0.949</td>
<td style="text-align: right;"><strong>0.950</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.999</td>
<td style="text-align: right;"><strong>1.000</strong></td>
<td style="text-align: right;">0.001 + 0.999</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.001 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.001 + 0.999</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.001 + 0.999</td>
<td style="text-align: right;"><strong>1.000</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.008 + 0.251</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.002 + 0.250</td>
<td style="text-align: right;">0.252</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.010 + 0.135</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.002 + 0.127</td>
<td style="text-align: right;">0.129</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.009 + 0.091</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.002 + 0.069</td>
<td style="text-align: right;">0.071</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.009 + 0.095</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.002 + 0.046</td>
<td style="text-align: right;">0.047</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.009 + 0.149</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.001 + 0.039</td>
<td style="text-align: right;">0.041</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.009 + 0.280</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.002 + 0.077</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.009 + 0.553</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.002 + 0.137</td>
<td style="text-align: right;">0.139</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.138 + 0.988</td>
<td style="text-align: right;">1.127</td>
<td style="text-align: right;">0.247 + 0.993</td>
<td style="text-align: right;">1.240</td>
<td style="text-align: right;">0.002 + 0.262</td>
<td style="text-align: right;">0.264</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;"><strong>0.001</strong></td>
<td style="text-align: right;">0.070 + 1.008</td>
<td style="text-align: right;">1.078</td>
<td style="text-align: right;">0.125 + 1.019</td>
<td style="text-align: right;">1.144</td>
<td style="text-align: right;">0.041 + 0.522</td>
<td style="text-align: right;"><strong>0.563</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.254 + 0.998</td>
<td style="text-align: right;"><strong>1.252</strong></td>
<td style="text-align: right;">0.038 + 1.031</td>
<td style="text-align: right;">1.069</td>
<td style="text-align: right;">0.060 + 1.063</td>
<td style="text-align: right;">1.123</td>
<td style="text-align: right;">0.044 + 0.947</td>
<td style="text-align: right;"><strong>0.992</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.260 + 0.999</td>
<td style="text-align: right;">1.260</td>
<td style="text-align: right;">0.096 + 1.022</td>
<td style="text-align: right;">1.118</td>
<td style="text-align: right;">0.020 + 1.034</td>
<td style="text-align: right;">1.054</td>
<td style="text-align: right;">0.033 + 1.065</td>
<td style="text-align: right;">1.098</td>
<td style="text-align: right;">0.023 + 1.014</td>
<td style="text-align: right;"><strong>1.037</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">0.000 + 6.500</td>
<td style="text-align: right;">6.500</td>
<td style="text-align: right;">0.000 + 6.999</td>
<td style="text-align: right;"><strong>6.999</strong></td>
<td style="text-align: right;">0.000 + 8.421</td>
<td style="text-align: right;">8.421</td>
<td style="text-align: right;">0.000 + 7.993</td>
<td style="text-align: right;">7.993</td>
<td style="text-align: right;">0.000 + 7.349</td>
<td style="text-align: right;"><strong>7.349</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Skipless</td>
<td style="text-align: right;">0.000 + 1.999</td>
<td style="text-align: right;">1.999</td>
<td style="text-align: right;">0.002 + 2.997</td>
<td style="text-align: right;"><strong>2.999</strong></td>
<td style="text-align: right;">0.046 + 6.040</td>
<td style="text-align: right;">6.086</td>
<td style="text-align: right;">0.008 + 4.987</td>
<td style="text-align: right;">4.995</td>
<td style="text-align: right;">0.012 + 3.978</td>
<td style="text-align: right;"><strong>3.990</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Pure</td>
<td style="text-align: right;">0.260 + 1.999</td>
<td style="text-align: right;">2.259</td>
<td style="text-align: right;">0.349 + 3.019</td>
<td style="text-align: right;"><strong>3.369</strong></td>
<td style="text-align: right;">0.326 + 6.116</td>
<td style="text-align: right;">6.443</td>
<td style="text-align: right;">0.465 + 5.137</td>
<td style="text-align: right;">5.601</td>
<td style="text-align: right;">0.122 + 3.990</td>
<td style="text-align: right;"><strong>4.113</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blend</td>
<td style="text-align: right;">0.260 + 1.999</td>
<td style="text-align: right;">2.259</td>
<td style="text-align: right;">0.349 + 3.019</td>
<td style="text-align: right;"><strong>3.369</strong></td>
<td style="text-align: right;">0.316 + 6.119</td>
<td style="text-align: right;">6.434</td>
<td style="text-align: right;">0.465 + 5.137</td>
<td style="text-align: right;">5.601</td>
<td style="text-align: right;">0.120 + 3.990</td>
<td style="text-align: right;"><strong>4.111</strong></td>
</tr>
</tbody>
</table>
<p>The pattern for our next set of experiments is that of merging sets
of presorted data. The next table shows counts of comparisons for a
sampling of tasks. The results for merging exactly 2, 4 or 16 presorts
should be good for any method, insofar as they can operate as sorting
presorted data in the first subsort stages and then transition to final
stages more like those for sorting uniformly random arrangements. When
the subsort sizes are not a power-of-two division, or the block
distribution is uneven, we expect performance to degrade more.
Nonetheless it is important that the degradation is not precipitous.</p>
<table>
<caption>Results for experiments that simulate appending new data to an
existing (pre-) sorted set of data such that the size of the combined
dataset is 4096. Proportionately small size increases are shown. In 2 of
the cases the boundary between the end of the presorted set and the
uniformly randomly valued new data is at a power-of-two boundary. That
is to say that the appended data set falls exactly into a
subsort.</caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">Append 64 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">71 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">91 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">128 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">181 …</th>
<th style="text-align: right;">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.503</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.000 + 0.503</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.000 + 0.504</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.000 + 0.505</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">0.000 + 0.508</td>
<td style="text-align: right;">0.508</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.000 + 0.505</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">0.000 + 0.505</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">0.000 + 0.507</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.000 + 0.509</td>
<td style="text-align: right;">0.509</td>
<td style="text-align: right;">0.000 + 0.513</td>
<td style="text-align: right;">0.513</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.512</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">0.000 + 0.513</td>
<td style="text-align: right;">0.513</td>
<td style="text-align: right;">0.000 + 0.517</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.000 + 0.524</td>
<td style="text-align: right;">0.524</td>
<td style="text-align: right;">0.000 + 0.535</td>
<td style="text-align: right;">0.535</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.508</td>
<td style="text-align: right;">0.508</td>
<td style="text-align: right;">0.000 + 0.509</td>
<td style="text-align: right;">0.509</td>
<td style="text-align: right;">0.000 + 0.511</td>
<td style="text-align: right;">0.511</td>
<td style="text-align: right;">0.000 + 0.516</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">0.000 + 0.523</td>
<td style="text-align: right;">0.523</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.006 + 0.252</td>
<td style="text-align: right;">0.257</td>
<td style="text-align: right;">0.006 + 0.252</td>
<td style="text-align: right;">0.258</td>
<td style="text-align: right;">0.008 + 0.252</td>
<td style="text-align: right;">0.261</td>
<td style="text-align: right;">0.012 + 0.253</td>
<td style="text-align: right;">0.265</td>
<td style="text-align: right;">0.017 + 0.255</td>
<td style="text-align: right;">0.272</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.004 + 0.133</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.005 + 0.134</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.007 + 0.137</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">0.009 + 0.141</td>
<td style="text-align: right;">0.150</td>
<td style="text-align: right;">0.012 + 0.148</td>
<td style="text-align: right;">0.161</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.262</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.000 + 0.263</td>
<td style="text-align: right;">0.264</td>
<td style="text-align: right;">0.000 + 0.267</td>
<td style="text-align: right;">0.268</td>
<td style="text-align: right;">0.000 + 0.274</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">0.000 + 0.285</td>
<td style="text-align: right;">0.285</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.508</td>
<td style="text-align: right;">0.508</td>
<td style="text-align: right;">0.000 + 0.509</td>
<td style="text-align: right;">0.509</td>
<td style="text-align: right;">0.000 + 0.511</td>
<td style="text-align: right;"><strong>0.512</strong></td>
<td style="text-align: right;">0.000 + 0.516</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.000 + 0.523</td>
<td style="text-align: right;">0.524</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.009 + 0.251</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.010 + 0.251</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.013 + 0.252</td>
<td style="text-align: right;">0.265</td>
<td style="text-align: right;">0.018 + 0.253</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">0.026 + 0.254</td>
<td style="text-align: right;">0.280</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.007 + 0.133</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.008 + 0.134</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">0.010 + 0.136</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.014 + 0.141</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.020 + 0.147</td>
<td style="text-align: right;">0.167</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.004 + 0.075</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.005 + 0.077</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.006 + 0.080</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.008 + 0.087</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">0.012 + 0.098</td>
<td style="text-align: right;">0.110</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.002 + 0.046</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.003 + 0.050</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.004 + 0.052</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.005 + 0.060</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.007 + 0.072</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.001 + 0.031</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.002 + 0.039</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.002 + 0.042</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.003 + 0.047</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.004 + 0.060</td>
<td style="text-align: right;">0.064</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.001 + 0.014</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">0.001 + 0.027</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.001 + 0.032</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.002 + 0.040</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.002 + 0.062</td>
<td style="text-align: right;">0.064</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.001 + 0.043</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.001 + 0.043</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.001 + 0.046</td>
<td style="text-align: right;">0.047</td>
<td style="text-align: right;">0.001 + 0.032</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.002 + 0.060</td>
<td style="text-align: right;">0.062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.001 + 0.072</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.001 + 0.072</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.001 + 0.076</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">0.001 + 0.082</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.001 + 0.088</td>
<td style="text-align: right;">0.089</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.001 + 0.134</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">0.001 + 0.134</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">0.001 + 0.137</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.001 + 0.143</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">0.001 + 0.150</td>
<td style="text-align: right;">0.151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.001 + 0.258</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.001 + 0.259</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.001 + 0.261</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.001 + 0.267</td>
<td style="text-align: right;">0.268</td>
<td style="text-align: right;">0.001 + 0.273</td>
<td style="text-align: right;">0.274</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.475 + 0.493</td>
<td style="text-align: right;">0.968</td>
<td style="text-align: right;">0.476 + 0.495</td>
<td style="text-align: right;">0.971</td>
<td style="text-align: right;">0.480 + 0.501</td>
<td style="text-align: right;"><strong>0.981</strong></td>
<td style="text-align: right;">0.478 + 0.509</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: right;">0.471 + 0.519</td>
<td style="text-align: right;">0.990</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">0.000 + 6.097</td>
<td style="text-align: right;">6.097</td>
<td style="text-align: right;">0.000 + 6.111</td>
<td style="text-align: right;">6.111</td>
<td style="text-align: right;">0.000 + 6.143</td>
<td style="text-align: right;">6.143</td>
<td style="text-align: right;">0.000 + 6.193</td>
<td style="text-align: right;">6.193</td>
<td style="text-align: right;">0.000 + 6.271</td>
<td style="text-align: right;">6.271</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Skipless</td>
<td style="text-align: right;">0.018 + 2.094</td>
<td style="text-align: right;">2.112</td>
<td style="text-align: right;">0.021 + 2.127</td>
<td style="text-align: right;">2.148</td>
<td style="text-align: right;">0.025 + 2.162</td>
<td style="text-align: right;">2.187</td>
<td style="text-align: right;">0.033 + 2.209</td>
<td style="text-align: right;">2.242</td>
<td style="text-align: right;">0.047 + 2.337</td>
<td style="text-align: right;">2.384</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pure</td>
<td style="text-align: right;">0.503 + 2.049</td>
<td style="text-align: right;">2.553</td>
<td style="text-align: right;">0.509 + 2.082</td>
<td style="text-align: right;">2.591</td>
<td style="text-align: right;">0.519 + 2.116</td>
<td style="text-align: right;">2.635</td>
<td style="text-align: right;">0.531 + 2.160</td>
<td style="text-align: right;">2.691</td>
<td style="text-align: right;">0.546 + 2.284</td>
<td style="text-align: right;">2.830</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blend</td>
<td style="text-align: right;">0.496 + 2.050</td>
<td style="text-align: right;"><strong>2.546</strong></td>
<td style="text-align: right;">0.500 + 2.084</td>
<td style="text-align: right;"><strong>2.584</strong></td>
<td style="text-align: right;">0.509 + 2.117</td>
<td style="text-align: right;"><strong>2.626</strong></td>
<td style="text-align: right;">0.516 + 2.161</td>
<td style="text-align: right;"><strong>2.677</strong></td>
<td style="text-align: right;">0.525 + 2.286</td>
<td style="text-align: right;"><strong>2.811</strong></td>
</tr>
</tbody>
</table>
<p>Our next set of results are for the task of appending data to a
presorted dataset, and re-sorting. These are set out in the next table.
The final sort size is 4096 in experiments reported herein. We see that,
for enhanced sorts, there is a noticeable but not dramatic benefit from
alignment with a power-of-two boundary.</p>
<h3 data-number="7.2.3" id="additional-patterns-and-tests"><span
class="header-section-number">7.2.3</span> Additional patterns and
tests</h3>
<table>
<caption>Results where the pattern is a sequence of ascending blocks,
each internally unsorted. The performance of all methods varies
substantially with the number and size of sub-blocks. As expected, the
performance when bucketing is imperfect is lower</caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">4 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">7 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">16 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">16 / 1% …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">Uneven 4 …</th>
<th style="text-align: right;">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.666</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.000 + 0.666</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.000 + 0.667</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.000 + 0.667</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.000 + 0.667</td>
<td style="text-align: right;">0.667</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.998</td>
<td style="text-align: right;">0.998</td>
<td style="text-align: right;">0.000 + 0.783</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.869</td>
<td style="text-align: right;">0.869</td>
<td style="text-align: right;">0.000 + 0.851</td>
<td style="text-align: right;">0.851</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.642</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.897</td>
<td style="text-align: right;">0.897</td>
<td style="text-align: right;">0.000 + 0.968</td>
<td style="text-align: right;">0.968</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.571</td>
<td style="text-align: right;">0.571</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.948</td>
<td style="text-align: right;">0.948</td>
<td style="text-align: right;">0.000 + 0.704</td>
<td style="text-align: right;">0.704</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.375 + 0.355</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.374 + 0.354</td>
<td style="text-align: right;">0.728</td>
<td style="text-align: right;">0.375 + 0.355</td>
<td style="text-align: right;">0.730</td>
<td style="text-align: right;">0.375 + 0.354</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.375 + 0.354</td>
<td style="text-align: right;">0.729</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.003 + 0.998</td>
<td style="text-align: right;"><strong>1.001</strong></td>
<td style="text-align: right;">0.003 + 0.783</td>
<td style="text-align: right;">0.786</td>
<td style="text-align: right;">0.002 + 0.125</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">0.003 + 0.795</td>
<td style="text-align: right;">0.798</td>
<td style="text-align: right;">0.003 + 0.851</td>
<td style="text-align: right;">0.854</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.001 + 0.248</td>
<td style="text-align: right;"><strong>0.249</strong></td>
<td style="text-align: right;">0.001 + 0.639</td>
<td style="text-align: right;">0.641</td>
<td style="text-align: right;">0.001 + 0.065</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.001 + 0.881</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.001 + 0.968</td>
<td style="text-align: right;">0.969</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.123</td>
<td style="text-align: right;"><strong>0.123</strong></td>
<td style="text-align: right;">0.001 + 0.563</td>
<td style="text-align: right;">0.563</td>
<td style="text-align: right;">0.000 + 0.032</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">0.001 + 0.948</td>
<td style="text-align: right;">0.949</td>
<td style="text-align: right;">0.001 + 0.704</td>
<td style="text-align: right;">0.705</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.583 + 0.333</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">0.582 + 0.333</td>
<td style="text-align: right;">0.916</td>
<td style="text-align: right;">0.584 + 0.334</td>
<td style="text-align: right;">0.918</td>
<td style="text-align: right;">0.584 + 0.333</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">0.583 + 0.333</td>
<td style="text-align: right;">0.917</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.441 + 0.627</td>
<td style="text-align: right;">1.068</td>
<td style="text-align: right;">0.441 + 0.626</td>
<td style="text-align: right;">1.067</td>
<td style="text-align: right;">0.440 + 0.629</td>
<td style="text-align: right;">1.069</td>
<td style="text-align: right;">0.440 + 0.627</td>
<td style="text-align: right;">1.067</td>
<td style="text-align: right;">0.441 + 0.626</td>
<td style="text-align: right;">1.067</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.267 + 0.840</td>
<td style="text-align: right;">1.107</td>
<td style="text-align: right;">0.266 + 0.833</td>
<td style="text-align: right;">1.100</td>
<td style="text-align: right;">0.267 + 0.840</td>
<td style="text-align: right;">1.107</td>
<td style="text-align: right;">0.267 + 0.841</td>
<td style="text-align: right;">1.109</td>
<td style="text-align: right;">0.266 + 0.836</td>
<td style="text-align: right;">1.102</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.155 + 0.965</td>
<td style="text-align: right;">1.119</td>
<td style="text-align: right;">0.155 + 0.953</td>
<td style="text-align: right;">1.108</td>
<td style="text-align: right;">0.155 + 0.967</td>
<td style="text-align: right;">1.122</td>
<td style="text-align: right;">0.155 + 0.968</td>
<td style="text-align: right;">1.122</td>
<td style="text-align: right;">0.155 + 0.958</td>
<td style="text-align: right;">1.113</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.088 + 1.017</td>
<td style="text-align: right;">1.105</td>
<td style="text-align: right;">0.088 + 0.992</td>
<td style="text-align: right;">1.080</td>
<td style="text-align: right;">0.089 + 1.016</td>
<td style="text-align: right;">1.105</td>
<td style="text-align: right;">0.088 + 1.017</td>
<td style="text-align: right;">1.106</td>
<td style="text-align: right;">0.089 + 1.010</td>
<td style="text-align: right;">1.099</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.050 + 1.028</td>
<td style="text-align: right;">1.077</td>
<td style="text-align: right;">0.049 + 0.979</td>
<td style="text-align: right;">1.028</td>
<td style="text-align: right;">0.049 + 1.027</td>
<td style="text-align: right;">1.077</td>
<td style="text-align: right;">0.049 + 1.028</td>
<td style="text-align: right;">1.077</td>
<td style="text-align: right;">0.049 + 1.000</td>
<td style="text-align: right;">1.049</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.027 + 1.025</td>
<td style="text-align: right;">1.052</td>
<td style="text-align: right;">0.027 + 0.929</td>
<td style="text-align: right;">0.957</td>
<td style="text-align: right;">0.027 + 1.024</td>
<td style="text-align: right;">1.051</td>
<td style="text-align: right;">0.028 + 1.024</td>
<td style="text-align: right;">1.052</td>
<td style="text-align: right;">0.027 + 0.965</td>
<td style="text-align: right;">0.992</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.015 + 1.017</td>
<td style="text-align: right;">1.032</td>
<td style="text-align: right;">0.015 + 0.838</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.014 + 0.002</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">0.014 + 0.126</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.015 + 0.913</td>
<td style="text-align: right;">0.928</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.008 + 1.011</td>
<td style="text-align: right;"><strong>1.019</strong></td>
<td style="text-align: right;">0.008 + 0.651</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">0.007 + 0.001</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.008 + 0.275</td>
<td style="text-align: right;">0.283</td>
<td style="text-align: right;">0.008 + 0.864</td>
<td style="text-align: right;">0.872</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.004 + 0.000</td>
<td style="text-align: right;"><strong>0.005</strong></td>
<td style="text-align: right;">0.004 + 0.350</td>
<td style="text-align: right;">0.354</td>
<td style="text-align: right;">0.004 + 0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.006 + 0.520</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">0.004 + 0.754</td>
<td style="text-align: right;">0.759</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.002 + 0.000</td>
<td style="text-align: right;"><strong>0.002</strong></td>
<td style="text-align: right;">0.002 + 0.175</td>
<td style="text-align: right;">0.177</td>
<td style="text-align: right;">0.002 + 0.000</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.005 + 0.748</td>
<td style="text-align: right;">0.752</td>
<td style="text-align: right;">0.002 + 0.364</td>
<td style="text-align: right;">0.366</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">0.000 + 9.736</td>
<td style="text-align: right;"><strong>9.736</strong></td>
<td style="text-align: right;">0.000 + 9.524</td>
<td style="text-align: right;">9.524</td>
<td style="text-align: right;">0.000 + 8.744</td>
<td style="text-align: right;">8.744</td>
<td style="text-align: right;">0.000 + 10.256</td>
<td style="text-align: right;"><strong>10.256</strong></td>
<td style="text-align: right;">0.000 + 10.119</td>
<td style="text-align: right;"><strong>10.119</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Skipless</td>
<td style="text-align: right;">0.999 + 8.582</td>
<td style="text-align: right;"><strong>9.580</strong></td>
<td style="text-align: right;">0.998 + 8.983</td>
<td style="text-align: right;">9.980</td>
<td style="text-align: right;">0.996 + 6.688</td>
<td style="text-align: right;">7.684</td>
<td style="text-align: right;">0.998 + 9.545</td>
<td style="text-align: right;"><strong>10.543</strong></td>
<td style="text-align: right;">0.998 + 9.591</td>
<td style="text-align: right;">10.589</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pure</td>
<td style="text-align: right;">1.641 + 8.363</td>
<td style="text-align: right;"><strong>10.004</strong></td>
<td style="text-align: right;">1.637 + 8.160</td>
<td style="text-align: right;">9.797</td>
<td style="text-align: right;">1.638 + 6.339</td>
<td style="text-align: right;">7.978</td>
<td style="text-align: right;">1.644 + 8.007</td>
<td style="text-align: right;">9.650</td>
<td style="text-align: right;">1.639 + 9.124</td>
<td style="text-align: right;"><strong>10.763</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blend</td>
<td style="text-align: right;">1.170 + 8.411</td>
<td style="text-align: right;"><strong>9.581</strong></td>
<td style="text-align: right;">1.167 + 8.209</td>
<td style="text-align: right;"><strong>9.377</strong></td>
<td style="text-align: right;">1.168 + 6.386</td>
<td style="text-align: right;"><strong>7.554</strong></td>
<td style="text-align: right;">1.173 + 8.053</td>
<td style="text-align: right;"><strong>9.227</strong></td>
<td style="text-align: right;">1.169 + 9.174</td>
<td style="text-align: right;"><strong>10.343</strong></td>
</tr>
</tbody>
</table>
<p>One can imagine scenarios in which the incoming data is partially
sorted. The next table shows the counts for some patterns that aim,
imperfectly, to capture such tasks. For this we would expect at least
reasonable performance. By that we mean that an enhanced sort should be
able to improve on mergesort when there are, say, more than 8 sub-blocks
to the pattern or where the sub-block sizes are favourable. We find that
uneven block sizes are indeed challenging</p>
<table>
<caption>Results for random clusters where the clustered data is
presorted. The results are listed by numbers of clusters, four with even
split and one with uneven split (<span
class="math inline">\(3:5:4:5\)</span>).</caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">4 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">7 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">11 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">16 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">Uneven 4 …</th>
<th style="text-align: right;">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.501</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.666</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.000 + 0.724</td>
<td style="text-align: right;">0.724</td>
<td style="text-align: right;">0.000 + 0.666</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.000 + 0.573</td>
<td style="text-align: right;"><strong>0.573</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.726</td>
<td style="text-align: right;">0.726</td>
<td style="text-align: right;">0.000 + 0.779</td>
<td style="text-align: right;">0.779</td>
<td style="text-align: right;">0.000 + 0.793</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.000 + 0.597</td>
<td style="text-align: right;"><strong>0.597</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.662</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">0.000 + 0.816</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">0.000 + 0.852</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.000 + 0.886</td>
<td style="text-align: right;">0.886</td>
<td style="text-align: right;">0.000 + 0.691</td>
<td style="text-align: right;"><strong>0.691</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.001 + 0.250</td>
<td style="text-align: right;">0.252</td>
<td style="text-align: right;">0.002 + 0.251</td>
<td style="text-align: right;">0.252</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.001 + 0.250</td>
<td style="text-align: right;">0.251</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.001 + 0.441</td>
<td style="text-align: right;">0.442</td>
<td style="text-align: right;">0.002 + 0.595</td>
<td style="text-align: right;"><strong>0.596</strong></td>
<td style="text-align: right;">0.002 + 0.532</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;">0.001 + 0.256</td>
<td style="text-align: right;"><strong>0.256</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.220</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">0.001 + 0.617</td>
<td style="text-align: right;">0.618</td>
<td style="text-align: right;">0.001 + 0.724</td>
<td style="text-align: right;"><strong>0.725</strong></td>
<td style="text-align: right;">0.001 + 0.751</td>
<td style="text-align: right;">0.752</td>
<td style="text-align: right;">0.000 + 0.378</td>
<td style="text-align: right;"><strong>0.378</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.547</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.001 + 0.769</td>
<td style="text-align: right;">0.770</td>
<td style="text-align: right;">0.001 + 0.839</td>
<td style="text-align: right;"><strong>0.840</strong></td>
<td style="text-align: right;">0.001 + 0.872</td>
<td style="text-align: right;">0.873</td>
<td style="text-align: right;">0.000 + 0.573</td>
<td style="text-align: right;"><strong>0.574</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.002 + 0.250</td>
<td style="text-align: right;">0.252</td>
<td style="text-align: right;">0.003 + 0.250</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.001 + 0.250</td>
<td style="text-align: right;">0.251</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.002 + 0.127</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: right;">0.004 + 0.128</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.001 + 0.126</td>
<td style="text-align: right;">0.127</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.002 + 0.069</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.003 + 0.073</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.001 + 0.066</td>
<td style="text-align: right;">0.066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.002 + 0.045</td>
<td style="text-align: right;">0.047</td>
<td style="text-align: right;">0.003 + 0.054</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.001 + 0.038</td>
<td style="text-align: right;">0.039</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.002 + 0.045</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.003 + 0.063</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.001 + 0.027</td>
<td style="text-align: right;">0.028</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.002 + 0.067</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.003 + 0.104</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.001 + 0.042</td>
<td style="text-align: right;">0.043</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.002 + 0.124</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">0.003 + 0.199</td>
<td style="text-align: right;">0.202</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.001 + 0.068</td>
<td style="text-align: right;">0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.002 + 0.242</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">0.021 + 0.374</td>
<td style="text-align: right;">0.396</td>
<td style="text-align: right;">0.246 + 0.002</td>
<td style="text-align: right;">0.248</td>
<td style="text-align: right;">0.001 + 0.127</td>
<td style="text-align: right;">0.128</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.025 + 0.406</td>
<td style="text-align: right;">0.431</td>
<td style="text-align: right;">0.040 + 0.475</td>
<td style="text-align: right;"><strong>0.516</strong></td>
<td style="text-align: right;">0.140 + 0.312</td>
<td style="text-align: right;">0.452</td>
<td style="text-align: right;">0.001 + 0.256</td>
<td style="text-align: right;"><strong>0.257</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.220 + 0.000</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">0.036 + 0.467</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.036 + 0.495</td>
<td style="text-align: right;"><strong>0.530</strong></td>
<td style="text-align: right;">0.097 + 0.480</td>
<td style="text-align: right;">0.577</td>
<td style="text-align: right;">0.013 + 0.343</td>
<td style="text-align: right;"><strong>0.356</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.166 + 0.313</td>
<td style="text-align: right;">0.478</td>
<td style="text-align: right;">0.037 + 0.476</td>
<td style="text-align: right;">0.513</td>
<td style="text-align: right;">0.047 + 0.537</td>
<td style="text-align: right;"><strong>0.584</strong></td>
<td style="text-align: right;">0.049 + 0.621</td>
<td style="text-align: right;">0.670</td>
<td style="text-align: right;">0.017 + 0.403</td>
<td style="text-align: right;"><strong>0.420</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">0.000 + 6.162</td>
<td style="text-align: right;"><strong>6.162</strong></td>
<td style="text-align: right;">0.000 + 6.894</td>
<td style="text-align: right;">6.894</td>
<td style="text-align: right;">0.000 + 7.155</td>
<td style="text-align: right;">7.155</td>
<td style="text-align: right;">0.000 + 6.845</td>
<td style="text-align: right;">6.845</td>
<td style="text-align: right;">0.000 + 6.459</td>
<td style="text-align: right;"><strong>6.459</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Skipless</td>
<td style="text-align: right;">0.001 + 1.767</td>
<td style="text-align: right;"><strong>1.768</strong></td>
<td style="text-align: right;">0.011 + 3.298</td>
<td style="text-align: right;">3.309</td>
<td style="text-align: right;">0.018 + 3.918</td>
<td style="text-align: right;">3.936</td>
<td style="text-align: right;">0.006 + 3.398</td>
<td style="text-align: right;">3.403</td>
<td style="text-align: right;">0.006 + 2.451</td>
<td style="text-align: right;"><strong>2.457</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Pure</td>
<td style="text-align: right;">0.386 + 1.312</td>
<td style="text-align: right;"><strong>1.698</strong></td>
<td style="text-align: right;">0.113 + 2.819</td>
<td style="text-align: right;">2.932</td>
<td style="text-align: right;">0.165 + 3.253</td>
<td style="text-align: right;">3.419</td>
<td style="text-align: right;">0.532 + 2.411</td>
<td style="text-align: right;">2.943</td>
<td style="text-align: right;">0.039 + 2.246</td>
<td style="text-align: right;"><strong>2.285</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blend</td>
<td style="text-align: right;">0.386 + 1.312</td>
<td style="text-align: right;"><strong>1.698</strong></td>
<td style="text-align: right;">0.110 + 2.819</td>
<td style="text-align: right;"><strong>2.930</strong></td>
<td style="text-align: right;">0.162 + 3.254</td>
<td style="text-align: right;"><strong>3.416</strong></td>
<td style="text-align: right;">0.532 + 2.411</td>
<td style="text-align: right;"><strong>2.943</strong></td>
<td style="text-align: right;">0.038 + 2.246</td>
<td style="text-align: right;"><strong>2.284</strong></td>
</tr>
</tbody>
</table>
<table>
<caption>Results for random clusters where the clustered data is
unsorted. The results are laid out in the same way as the previous
table.</caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">4 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">7 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">11 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">16 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">Uneven 4 …</th>
<th style="text-align: right;">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.667</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.000 + 0.667</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.000 + 0.667</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.000 + 0.666</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.000 + 0.666</td>
<td style="text-align: right;">0.666</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.998</td>
<td style="text-align: right;">0.998</td>
<td style="text-align: right;">0.000 + 0.814</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.000 + 0.797</td>
<td style="text-align: right;">0.797</td>
<td style="text-align: right;">0.000 + 0.666</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.000 + 0.924</td>
<td style="text-align: right;">0.924</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.783</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">0.000 + 0.799</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.000 + 0.793</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.000 + 0.829</td>
<td style="text-align: right;"><strong>0.829</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.662</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">0.000 + 0.834</td>
<td style="text-align: right;">0.834</td>
<td style="text-align: right;">0.000 + 0.857</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.000 + 0.886</td>
<td style="text-align: right;">0.886</td>
<td style="text-align: right;">0.000 + 0.765</td>
<td style="text-align: right;"><strong>0.765</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.375 + 0.354</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.375 + 0.354</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.374 + 0.354</td>
<td style="text-align: right;">0.728</td>
<td style="text-align: right;">0.374 + 0.354</td>
<td style="text-align: right;">0.728</td>
<td style="text-align: right;">0.375 + 0.354</td>
<td style="text-align: right;">0.729</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.003 + 0.998</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">0.003 + 0.813</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">0.003 + 0.797</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.002 + 0.540</td>
<td style="text-align: right;">0.543</td>
<td style="text-align: right;">0.003 + 0.924</td>
<td style="text-align: right;">0.927</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.001 + 0.254</td>
<td style="text-align: right;">0.255</td>
<td style="text-align: right;">0.001 + 0.782</td>
<td style="text-align: right;"><strong>0.783</strong></td>
<td style="text-align: right;">0.001 + 0.799</td>
<td style="text-align: right;"><strong>0.801</strong></td>
<td style="text-align: right;">0.001 + 0.746</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.001 + 0.829</td>
<td style="text-align: right;"><strong>0.831</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.001 + 0.543</td>
<td style="text-align: right;">0.543</td>
<td style="text-align: right;">0.001 + 0.834</td>
<td style="text-align: right;"><strong>0.835</strong></td>
<td style="text-align: right;">0.001 + 0.857</td>
<td style="text-align: right;"><strong>0.858</strong></td>
<td style="text-align: right;">0.001 + 0.874</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.001 + 0.765</td>
<td style="text-align: right;"><strong>0.766</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.583 + 0.334</td>
<td style="text-align: right;">0.916</td>
<td style="text-align: right;">0.583 + 0.334</td>
<td style="text-align: right;">0.916</td>
<td style="text-align: right;">0.583 + 0.334</td>
<td style="text-align: right;">0.916</td>
<td style="text-align: right;">0.582 + 0.333</td>
<td style="text-align: right;">0.915</td>
<td style="text-align: right;">0.583 + 0.333</td>
<td style="text-align: right;">0.916</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.441 + 0.627</td>
<td style="text-align: right;">1.068</td>
<td style="text-align: right;">0.440 + 0.625</td>
<td style="text-align: right;">1.065</td>
<td style="text-align: right;">0.441 + 0.625</td>
<td style="text-align: right;">1.066</td>
<td style="text-align: right;">0.441 + 0.628</td>
<td style="text-align: right;">1.070</td>
<td style="text-align: right;">0.441 + 0.628</td>
<td style="text-align: right;">1.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.267 + 0.841</td>
<td style="text-align: right;">1.108</td>
<td style="text-align: right;">0.266 + 0.834</td>
<td style="text-align: right;">1.100</td>
<td style="text-align: right;">0.265 + 0.832</td>
<td style="text-align: right;">1.097</td>
<td style="text-align: right;">0.266 + 0.840</td>
<td style="text-align: right;">1.107</td>
<td style="text-align: right;">0.266 + 0.837</td>
<td style="text-align: right;">1.103</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.155 + 0.965</td>
<td style="text-align: right;">1.120</td>
<td style="text-align: right;">0.154 + 0.952</td>
<td style="text-align: right;">1.106</td>
<td style="text-align: right;">0.155 + 0.945</td>
<td style="text-align: right;">1.099</td>
<td style="text-align: right;">0.155 + 0.966</td>
<td style="text-align: right;">1.122</td>
<td style="text-align: right;">0.155 + 0.959</td>
<td style="text-align: right;">1.113</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.088 + 1.016</td>
<td style="text-align: right;">1.104</td>
<td style="text-align: right;">0.088 + 0.992</td>
<td style="text-align: right;">1.080</td>
<td style="text-align: right;">0.088 + 0.976</td>
<td style="text-align: right;">1.063</td>
<td style="text-align: right;">0.088 + 1.016</td>
<td style="text-align: right;">1.105</td>
<td style="text-align: right;">0.089 + 1.009</td>
<td style="text-align: right;">1.098</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.050 + 1.028</td>
<td style="text-align: right;">1.078</td>
<td style="text-align: right;">0.049 + 0.978</td>
<td style="text-align: right;">1.028</td>
<td style="text-align: right;">0.049 + 0.948</td>
<td style="text-align: right;">0.997</td>
<td style="text-align: right;">0.049 + 1.027</td>
<td style="text-align: right;">1.077</td>
<td style="text-align: right;">0.049 + 1.005</td>
<td style="text-align: right;">1.055</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.027 + 1.024</td>
<td style="text-align: right;">1.052</td>
<td style="text-align: right;">0.027 + 0.933</td>
<td style="text-align: right;">0.960</td>
<td style="text-align: right;">0.027 + 0.873</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.027 + 1.023</td>
<td style="text-align: right;">1.051</td>
<td style="text-align: right;">0.027 + 0.968</td>
<td style="text-align: right;">0.995</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.015 + 1.017</td>
<td style="text-align: right;">1.032</td>
<td style="text-align: right;">0.015 + 0.840</td>
<td style="text-align: right;">0.855</td>
<td style="text-align: right;">0.014 + 0.729</td>
<td style="text-align: right;">0.743</td>
<td style="text-align: right;">0.014 + 0.002</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.015 + 0.911</td>
<td style="text-align: right;">0.926</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.008 + 1.011</td>
<td style="text-align: right;">1.020</td>
<td style="text-align: right;">0.008 + 0.656</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.008 + 0.459</td>
<td style="text-align: right;">0.467</td>
<td style="text-align: right;">0.009 + 0.092</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.008 + 0.889</td>
<td style="text-align: right;">0.898</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.004 + 0.000</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.004 + 0.393</td>
<td style="text-align: right;"><strong>0.397</strong></td>
<td style="text-align: right;">0.004 + 0.368</td>
<td style="text-align: right;"><strong>0.372</strong></td>
<td style="text-align: right;">0.005 + 0.225</td>
<td style="text-align: right;">0.230</td>
<td style="text-align: right;">0.004 + 0.664</td>
<td style="text-align: right;">0.668</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.003 + 0.064</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.002 + 0.353</td>
<td style="text-align: right;"><strong>0.356</strong></td>
<td style="text-align: right;">0.003 + 0.443</td>
<td style="text-align: right;"><strong>0.446</strong></td>
<td style="text-align: right;">0.003 + 0.432</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">0.002 + 0.379</td>
<td style="text-align: right;">0.381</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">0.000 + 9.900</td>
<td style="text-align: right;">9.900</td>
<td style="text-align: right;">0.000 + 9.958</td>
<td style="text-align: right;">9.958</td>
<td style="text-align: right;">0.000 + 9.863</td>
<td style="text-align: right;">9.863</td>
<td style="text-align: right;">0.000 + 9.589</td>
<td style="text-align: right;">9.589</td>
<td style="text-align: right;">0.000 + 10.138</td>
<td style="text-align: right;"><strong>10.138</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Skipless</td>
<td style="text-align: right;">0.998 + 9.008</td>
<td style="text-align: right;">10.006</td>
<td style="text-align: right;">0.998 + 9.424</td>
<td style="text-align: right;">10.422</td>
<td style="text-align: right;">0.997 + 9.330</td>
<td style="text-align: right;">10.327</td>
<td style="text-align: right;">0.994 + 8.631</td>
<td style="text-align: right;">9.625</td>
<td style="text-align: right;">0.999 + 9.611</td>
<td style="text-align: right;"><strong>10.610</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Pure</td>
<td style="text-align: right;">1.641 + 8.428</td>
<td style="text-align: right;">10.069</td>
<td style="text-align: right;">1.638 + 8.390</td>
<td style="text-align: right;">10.028</td>
<td style="text-align: right;">1.636 + 8.031</td>
<td style="text-align: right;">9.667</td>
<td style="text-align: right;">1.641 + 7.086</td>
<td style="text-align: right;">8.727</td>
<td style="text-align: right;">1.640 + 9.082</td>
<td style="text-align: right;"><strong>10.722</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blend</td>
<td style="text-align: right;">1.170 + 8.475</td>
<td style="text-align: right;"><strong>9.646</strong></td>
<td style="text-align: right;">1.167 + 8.440</td>
<td style="text-align: right;"><strong>9.608</strong></td>
<td style="text-align: right;">1.166 + 8.081</td>
<td style="text-align: right;"><strong>9.247</strong></td>
<td style="text-align: right;">1.170 + 7.134</td>
<td style="text-align: right;"><strong>8.304</strong></td>
<td style="text-align: right;">1.170 + 9.131</td>
<td style="text-align: right;"><strong>10.301</strong></td>
</tr>
</tbody>
</table>
<p>The next two tables show results for random but distinct clusters. In
the first of the two the clusters are presorted, whereas in the second
they are not. Various sizings were tested.</p>
<table>
<caption>Counts of comparisons for patterns of increasing size with
<span class="math inline">\(0.1\%\)</span> of members having displaced
values. The results for 4096 supplements earlier results.</caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">2048 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">4096 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">8192 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">16384 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">32768 …</th>
<th style="text-align: right;">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.501</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.000 + 0.501</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.000 + 0.501</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.000 + 0.501</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.000 + 0.501</td>
<td style="text-align: right;">0.501</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.000 + 0.502</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.000 + 0.502</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.000 + 0.502</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.000 + 0.502</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.000 + 0.502</td>
<td style="text-align: right;">0.502</td>
</tr>
<tr class="even">
<td style="text-align: left;">s-3</td>
<td style="text-align: right;">0.000 + 0.610</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">0.000 + 0.671</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">0.000 + 0.754</td>
<td style="text-align: right;">0.754</td>
<td style="text-align: right;">0.000 + 0.844</td>
<td style="text-align: right;">0.844</td>
<td style="text-align: right;">0.000 + 0.917</td>
<td style="text-align: right;">0.917</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s-2</td>
<td style="text-align: right;">0.000 + 0.663</td>
<td style="text-align: right;">0.663</td>
<td style="text-align: right;">0.000 + 0.756</td>
<td style="text-align: right;">0.756</td>
<td style="text-align: right;">0.000 + 0.825</td>
<td style="text-align: right;">0.825</td>
<td style="text-align: right;">0.000 + 0.892</td>
<td style="text-align: right;">0.892</td>
<td style="text-align: right;">0.000 + 0.935</td>
<td style="text-align: right;">0.935</td>
</tr>
<tr class="even">
<td style="text-align: left;">s-1</td>
<td style="text-align: right;">0.000 + 0.686</td>
<td style="text-align: right;">0.686</td>
<td style="text-align: right;">0.000 + 0.815</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">0.000 + 0.886</td>
<td style="text-align: right;">0.886</td>
<td style="text-align: right;">0.000 + 0.940</td>
<td style="text-align: right;">0.940</td>
<td style="text-align: right;">0.000 + 0.966</td>
<td style="text-align: right;">0.966</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.002 + 0.250</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.002 + 0.251</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.002 + 0.250</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.002 + 0.250</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.002 + 0.250</td>
<td style="text-align: right;">0.253</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.002 + 0.128</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.002 + 0.128</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.002 + 0.128</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.002 + 0.128</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.002 + 0.128</td>
<td style="text-align: right;">0.130</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s-3</td>
<td style="text-align: right;">0.001 + 0.228</td>
<td style="text-align: right;">0.229</td>
<td style="text-align: right;">0.001 + 0.376</td>
<td style="text-align: right;">0.377</td>
<td style="text-align: right;">0.001 + 0.554</td>
<td style="text-align: right;">0.555</td>
<td style="text-align: right;">0.001 + 0.734</td>
<td style="text-align: right;">0.735</td>
<td style="text-align: right;">0.000 + 0.872</td>
<td style="text-align: right;">0.872</td>
</tr>
<tr class="even">
<td style="text-align: left;">s-2</td>
<td style="text-align: right;">0.001 + 0.377</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">0.001 + 0.594</td>
<td style="text-align: right;">0.595</td>
<td style="text-align: right;">0.001 + 0.723</td>
<td style="text-align: right;">0.723</td>
<td style="text-align: right;">0.000 + 0.857</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.000 + 0.930</td>
<td style="text-align: right;">0.930</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s-1</td>
<td style="text-align: right;">0.001 + 0.546</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">0.001 + 0.750</td>
<td style="text-align: right;">0.751</td>
<td style="text-align: right;">0.000 + 0.881</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">0.000 + 0.940</td>
<td style="text-align: right;">0.940</td>
<td style="text-align: right;">0.000 + 0.966</td>
<td style="text-align: right;">0.966</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.003 + 0.250</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.004 + 0.251</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.004 + 0.250</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.003 + 0.250</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.003 + 0.250</td>
<td style="text-align: right;">0.254</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.003 + 0.127</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.003 + 0.128</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.003 + 0.128</td>
<td style="text-align: right;">0.131</td>
<td style="text-align: right;">0.003 + 0.128</td>
<td style="text-align: right;">0.131</td>
<td style="text-align: right;">0.003 + 0.128</td>
<td style="text-align: right;">0.131</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.003 + 0.069</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.003 + 0.069</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.003 + 0.069</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.003 + 0.069</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.003 + 0.069</td>
<td style="text-align: right;">0.072</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.003 + 0.046</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.003 + 0.046</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.003 + 0.045</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.003 + 0.046</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.003 + 0.045</td>
<td style="text-align: right;">0.048</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.003 + 0.047</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.003 + 0.045</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.003 + 0.045</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.003 + 0.044</td>
<td style="text-align: right;">0.047</td>
<td style="text-align: right;">0.003 + 0.046</td>
<td style="text-align: right;">0.048</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s-4</td>
<td style="text-align: right;">0.006 + 0.115</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">0.014 + 0.195</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">0.032 + 0.295</td>
<td style="text-align: right;">0.327</td>
<td style="text-align: right;">0.044 + 0.410</td>
<td style="text-align: right;"><strong>0.453</strong></td>
<td style="text-align: right;">0.063 + 0.521</td>
<td style="text-align: right;"><strong>0.584</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">s-3</td>
<td style="text-align: right;">0.020 + 0.190</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">0.032 + 0.298</td>
<td style="text-align: right;">0.330</td>
<td style="text-align: right;">0.059 + 0.417</td>
<td style="text-align: right;"><strong>0.477</strong></td>
<td style="text-align: right;">0.061 + 0.538</td>
<td style="text-align: right;"><strong>0.599</strong></td>
<td style="text-align: right;">0.073 + 0.697</td>
<td style="text-align: right;">0.770</td>
</tr>
<tr class="odd">
<td style="text-align: left;">s-2</td>
<td style="text-align: right;">0.063 + 0.288</td>
<td style="text-align: right;">0.351</td>
<td style="text-align: right;">0.096 + 0.432</td>
<td style="text-align: right;"><strong>0.529</strong></td>
<td style="text-align: right;">0.105 + 0.519</td>
<td style="text-align: right;"><strong>0.624</strong></td>
<td style="text-align: right;">0.121 + 0.715</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">0.109 + 0.843</td>
<td style="text-align: right;">0.952</td>
</tr>
<tr class="even">
<td style="text-align: left;">s-1</td>
<td style="text-align: right;">0.166 + 0.384</td>
<td style="text-align: right;"><strong>0.550</strong></td>
<td style="text-align: right;">0.170 + 0.549</td>
<td style="text-align: right;"><strong>0.718</strong></td>
<td style="text-align: right;">0.197 + 0.738</td>
<td style="text-align: right;">0.935</td>
<td style="text-align: right;">0.135 + 0.863</td>
<td style="text-align: right;">0.998</td>
<td style="text-align: right;">0.052 + 0.923</td>
<td style="text-align: right;">0.975</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">0.000 + 6.076</td>
<td style="text-align: right;"><strong>6.076</strong></td>
<td style="text-align: right;">0.000 + 6.971</td>
<td style="text-align: right;">6.971</td>
<td style="text-align: right;">0.000 + 7.861</td>
<td style="text-align: right;"><strong>7.861</strong></td>
<td style="text-align: right;">0.000 + 8.857</td>
<td style="text-align: right;">8.857</td>
<td style="text-align: right;">0.000 + 9.877</td>
<td style="text-align: right;"><strong>9.877</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Skipless</td>
<td style="text-align: right;">0.015 + 2.382</td>
<td style="text-align: right;">2.398</td>
<td style="text-align: right;">0.016 + 3.176</td>
<td style="text-align: right;">3.192</td>
<td style="text-align: right;">0.016 + 3.975</td>
<td style="text-align: right;">3.991</td>
<td style="text-align: right;">0.016 + 4.921</td>
<td style="text-align: right;">4.937</td>
<td style="text-align: right;">0.016 + 5.903</td>
<td style="text-align: right;">5.919</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pure</td>
<td style="text-align: right;">0.274 + 2.080</td>
<td style="text-align: right;">2.353</td>
<td style="text-align: right;">0.335 + 2.696</td>
<td style="text-align: right;">3.031</td>
<td style="text-align: right;">0.428 + 3.380</td>
<td style="text-align: right;">3.808</td>
<td style="text-align: right;">0.416 + 4.243</td>
<td style="text-align: right;">4.659</td>
<td style="text-align: right;">0.394 + 5.097</td>
<td style="text-align: right;">5.491</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blend</td>
<td style="text-align: right;">0.270 + 2.081</td>
<td style="text-align: right;"><strong>2.351</strong></td>
<td style="text-align: right;">0.332 + 2.697</td>
<td style="text-align: right;">3.029</td>
<td style="text-align: right;">0.425 + 3.381</td>
<td style="text-align: right;"><strong>3.806</strong></td>
<td style="text-align: right;">0.412 + 4.244</td>
<td style="text-align: right;">4.656</td>
<td style="text-align: right;">0.390 + 5.099</td>
<td style="text-align: right;"><strong>5.489</strong></td>
</tr>
</tbody>
</table>
<table>
<caption>Results for the basic size-4096 presort pattern followed by the
comparison counts for slightly smaller (4095) and larger (4097) presort
patterns. These are followed by counts for input datasets size 4095 and
4097 where the presorted data was reversed. While it might be argued
that such variations do not map to exact read-life scenarios, they can
help us in investigating robustness.</caption>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">Presort …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">4095 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">4097 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">Reverse 4095 …</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">4097 …</th>
<th style="text-align: right;">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;"><strong>1.000</strong></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;"><strong>0.000</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.000 + 0.500</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.000 + 0.250</td>
<td style="text-align: right;">0.250</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.000 + 0.125</td>
<td style="text-align: right;">0.125</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.000 + 0.063</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.000 + 0.063</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">0.000 + 0.062</td>
<td style="text-align: right;">0.062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.000 + 0.031</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.000 + 0.016</td>
<td style="text-align: right;">0.016</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.000 + 0.008</td>
<td style="text-align: right;">0.008</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000 + 0.004</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.000 + 0.002</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.000 + 0.001</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.000 + 0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">0.000 + 6.000</td>
<td style="text-align: right;">6.000</td>
<td style="text-align: right;">0.000 + 6.001</td>
<td style="text-align: right;">6.001</td>
<td style="text-align: right;">0.000 + 6.998</td>
<td style="text-align: right;"><strong>6.998</strong></td>
<td style="text-align: right;">0.000 + 5.999</td>
<td style="text-align: right;">5.999</td>
<td style="text-align: right;">0.000 + 5.999</td>
<td style="text-align: right;"><strong>5.999</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Skipless</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pure</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Blend</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000 + 1.000</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
<p>Finally we conducted experiments across sort sizes. The next table
show comparison counts across increasing sizes with the same proportion
(<span class="math inline">\(0.1\%\)</span>) of displaced member values.
Thus the column for 4096 supplements earlier results. The absolute
number of displaced members of course increases with sort size, arguably
making the patterns more challenging. We also conducted tests when the
sort size is not an exact power of two, and on reverse-presorted data.
Results are shown in the last table. The 4096 presort is compared with
4095 and 4097, followed by reversed 4095 and 4097. The most notable
result is that, for our version of the classic mergesort, there is a
significant difference between forward and reverse of size 4097.</p>
</body>
</html>
